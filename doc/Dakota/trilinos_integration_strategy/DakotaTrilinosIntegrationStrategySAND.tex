\documentclass[pdf,ps2pdf,11pt]{SANDreport}
\usepackage{pslatex}
%Local stuff
\usepackage{graphicx}
\usepackage{latexsym}
\usepackage{color}
\usepackage[all]{draftcopy}
\input{rab_commands}

\raggedright

% If you want to relax some of the SAND98-0730 requirements, use the "relax"
% option. It adds spaces and boldface in the table of contents, and does not
% force the page layout sizes.
% e.g. \documentclass[relax,12pt]{SANDreport}
%
% You can also use the "strict" option, which applies even more of the
% SAND98-0730 guidelines. It gets rid of section numbers which are often
% useful; e.g. \documentclass[strict]{SANDreport}

% ---------------------------------------------------------------------------- %
%
% Set the title, author, and date
%

\title{\center
Trilinos and Dakota Intrusive and Nonintrusive Integration Strategy}
\author{
Roscoe A. Bartlett \\
Mike Edred \\
Department of Optimization and Uncertainty Estimation \\ \\
Andy Salinger \\
Bart van Bloemen Waanders \\
Department of Applied Math and Applications \\ \\
Sandia National Laboratories, Albuquerque NM 87185-1318 USA \\ }

% ---------------------------------------------------------------------------- %
% Set some things we need for SAND reports. These are mandatory
%
\SANDnum{SANDxxxx-xxxx}
\SANDprintDate{???}
\SANDauthor{Roscoe A. Bartlett, Mike Edred, Andy Salinger, Bart van Bloemen Waanders}

% ---------------------------------------------------------------------------- %
% The following definitions are optional. The values shown are the default
% ones provided by SANDreport.cls
%
\SANDreleaseType{Unlimited Release}
%\SANDreleaseType{Not approved for general release}

% ---------------------------------------------------------------------------- %
% The following definition does not have a default value and will not
% print anything, if not defined
%
%\SANDsupersed{SAND1901-0001}{January 1901}

% ---------------------------------------------------------------------------- %
%
% Start the document
%
\begin{document}

\maketitle

% ------------------------------------------------------------------------ %
% An Abstract is required for SAND reports
%

%\clearpage

%
\begin{abstract}
%

We need to work to better integrate intrusive and non-intrusive analysis and
optimization capabilities in Trilinos and Dakota.  Here we describe a
short-term strategy to begin this process which will have many practical
applications and will serve as a foundation for future work.

%
\end{abstract}
%

% ------------------------------------------------------------------------ %
% An Acknowledgement section is optional but important, if someone made
% contributions or helped beyond the normal part of a work assignment.
% Use \section* since we don't want it in the table of context
%
%\clearpage
%\section*{Acknowledgments}

%
%The format of this report is based on information found
%in~\cite{Sand98-0730}.

% ------------------------------------------------------------------------ %
% The table of contents and list of figures and tables
% Comment out \listoffigures and \listoftables if there are no
% figures or tables. Make sure this starts on an odd numbered page
%
\clearpage
\tableofcontents
%\listoffigures
%\listoftables

% ---------------------------------------------------------------------- %
% An optional preface or Foreword
%\clearpage
%\section{Preface}
%Although muggles usually have only limited experience with
%magic, and many even dispute its existence, it is worthwhile
%to be open minded and explore the possibilities.

% ---------------------------------------------------------------------- %
% An optional executive summary

%\clearpage

\section{Executive Summary}

Consensus opinions on integration of intrusive (Trilinos-based) and
non-intrusive (Dakota-based) analysis methods include that

\begin{itemize}

{}\item{}Intrusive and non-intrusive methods for optimization and UQ will both
have a prominent role in a future transformational approach to modeling and
simulation.

{}\item{}There would be benefits to tighter integration and interoperability
between intrusive in non-intrusive methods (as detailed below), that are both
technical and cultural.

{}\item{}Currently, there is no compelling reason to refactor the Dakota
capabilities into Trilinos or Trilinos capabilities into Dakota. However,
greater coordination and leveraging for software configuration, testing, and
quality requirements is recognized as being beneficial.

{}\item{}The appropriate first step in integration is to write an adapter that
specializes the in-core (compiled in) DAKOTA direct-linked application
interface ({}\texttt{Dakota\-::Direct\-Fn\-Applic\-Interface}) using the
ModelEvaluator software in Trilinos.

{}\item{}A common use of non-intrusive methods is to calculate responses (such
as objective functions) offline in post-processing scripts, for which
intrusive methods are not applicable.

{}\item{}Utilities that can be used both by Dakota and other codes should be
migrated to Trilinos.

\end{itemize}

{}\noindent\textbf{Plan:}

\begin{itemize}

{}\item{}Develop an adapter so that Dakota can run off of the Thyra
ModelEvaluator interface, first for systems constrained as steady-state
problems, then those constrained by transient, bifurcation, space-time,
intrusive optimization, and intrusive UQ solutions.

{}\item{}Extract utilities from Dakota that can have broader use, such as some
of the infrastructure for manipulating MPI communicators for multi-level
parallelism, and put into Trilinos.

{}\item{}Point to Dakota as a Trilinos third-party library (TPL) and develop
test and demonstration problems in Trilinos that make use of the new
integration.

\end{itemize}

{}\noindent\textbf{Benefits:}

\begin{itemize}

{}\item{}A more formal integration of having Dakota pointed to as a Trilinos
third-party library (TPL), and being used as part of Trilinos test and
demonstration problems, will shrink the barrier between the development
communities for intrusive and non-intrusive methods.

{}\item{}Analytic sensitivities computed for simulation-constrained problems
through intrusive direct or adjoint methods will be automatically available to
non-intrusive methods.

{}\item{}The in-core connection will expedite algorithm R\&D in hybrid
methods, such as nesting intrusive optimization inside non-intrusive UQ and
vice-versa. This brings together Dakota~s capabilities for top-level
coordination and recursion of multiple ``iterators'' and ''models,'' with an
emphasis on system-level design and certification studies, and the Trilinos
facilities for intrusive methods, with an emphasis on computational efficiency
on high-performance computers.

\end{itemize}

% ---------------------------------------------------------------------- %
% An optional glossary. We don't want it to be numbered
%\clearpage
%\section*{Nomenclature}
%\addcontentsline{toc}{section}{Nomenclature}
%\begin{itemize}
%\item[alohomora]
%spell to open locked doors and containers
%\end{itemize}

% ---------------------------------------------------------------------- %
% This is where the body of the report begins; usually with an Introduction
%


\SANDmain % Start the main part of the report


%
\section{Introduction}
%

Here we consider the analysis of simulation-constrained models.  Here we
consider a simplified form of a set of state equations that takes the form
%
\begin{equation}
f( x, p ) = 0
\label{eqn:state_func}
\end{equation}
%
where $x{}\in\RE^{n_x}$ are known as the {}\textit{state variables},
$p\in\RE^{n_p}$ are known as {}\textit{model parameters}, and
$f(x,p)\in\RE^{n_x\times{}n_p}\rightarrow\RE^{n_x}$ is the {}\textit{state
residual function}.  Here, the state model in (\ref{eqn:state_func}) will be a
discrete model which can come from the discretization of a PDE (in space and
time) or from any other type of model.  The key assumption that we will make
here initially is that the dimension and structure of the state, parameter,
and state function spaces are fixed (i.e., $n_x$ and $n_p$ are constant).  For
the purposes of the discussion is this section, we can treat discretizations
of both steady-state and transient models using the same abstract mathematical
model in (\ref{eqn:state_func}).

Another key assumption is that when the parameters $p\in\RE^{n_p}$ are given,
then (\ref{eqn:state_func}) defines an implicit function that gives $x=x(p)$.
The numerical algorithm that computes the implicit state function $x=x(p)$
will be refereed to as the {}\textit{nonlinear solver}.

The analysis that we perform on these simulation-constrained models is
typically focused on some {}\textit{response} of the system (also called an
{}\textit{observation} of the state in some literature).  For simplicity, lets
consider a single multi-component response function of the form
%
\begin{equation}
g( x, p ) \; \in \RE^{n_x \times n_p} \rightarrow \RE^{n_g}.
\label{eqn:response_func}
\end{equation}
%
Using the implicit function $x=x(p)$ defined by the nonlinear solver, we can
consider an reduced form of the response function
%
\begin{equation}
\hat{g}(p) \; \in \RE^{n_p} \rightarrow \RE^{n_g},
\label{eqn:red_response_func}
\end{equation}
%
where $\hat{g}(p) = g(x(p),p)$.  Note that every evaluation of the reduced
response function $\hat{g}(p)$ requires that the nonlinear solver re-converge
the state equations in (\ref{eqn:state_func}).

The reduced first derivative $\jac{\hat{g}}{p}$ is simply given as
%
\begin{equation}
\Jac{\hat{g}}{p} = \Jac{g}{x} \left[ - \left(\Jac{f}{x}\right)^{-1} \Jac{f}{x} \right] + \Jac{g}{p}
\; \in \RE^{n_p} \rightarrow \RE^{n_g \times n_p}
\label{eqn:red_response_func_deriv}
\end{equation}
%
which can be computed using either direct or adjoint methods (see [???]).

While some analysis methods can simultaneously consider both the state
variables $x$ and the model parameters $p$ along with the state functions
$f(x,p)=0$ and the full response functions $g(x,p)$, here we will consider
analysis methods that require that a nonlinear solver eliminate the state
variables and state equations from the model using some appropriate nonlinear
solver.  The Dakota software contains numerous analysis methods for reduced
response models $p {}\rightarrow {}\hat{g}$ and Dakota will be a focus on our
discussion here (but the approaches and software being considered will have
broader application than Dakota).

Here we define the {}\textit{intrusive} domain as the software and algorithms
that are concerned with the modeling and solution of the state equations in
(\ref{eqn:state_func}), the evaluation of the full responses
(\ref{eqn:response_func}), the computation of sensitivities such as
(\ref{eqn:red_response_func_deriv}), and similar quantities (e.g.\ more
general adjoints, second derivatives, polynomial expansions (for UQ)).  The
intrusive domain has been the realm of applications and large-scale solver
technology in Trilinos.

Likewise, we define the {}\textit{non-intrusive} domain as the software and
algorithms that only consider reduced response models
(\ref{eqn:red_response_func}) with little to no concern for how the state
equations of the underlying model are solved and the states eliminated from
the model.  The non-intrusive domain has been the realm of Dakota.

Below, we describe a plan for beginning to bridge the intrusive realm of
Trilinos with the non-intrusive realm of Dakota.

First, we provide an overview of an important building block from Trilinos
called the ModelEvaluator which provides the foundation for bridging the
intrusive and non-intrusive realms.

%
\section{Overview of the ModelEvaluator Mathematical Model}
%

The Trilinos ModelEvaluator software can be used to represent more general
forms of the full-space model with state functions (\ref{eqn:state_func}) and
response functions (\ref{eqn:response_func}) as well as the reduced form
(\ref{eqn:red_response_func}).

The most general form of the full model supported by the ModelEvaluator is
%
\begin{eqnarray}
( x, \{ p_l \} ) & \rightarrow & f \; \in\RE^{n_x \times n_p} \rightarrow \RE^{n_x}
\label{eqn:me:state_func} \\
( x, \{ p_l \} ) & \rightarrow & g_j \;  \in\RE^{n_x \times n_p} \rightarrow \RE^{n_{g(j)}},
\; j=0 \ldots N_g-1
\label{eqn:me:response_func}
\end{eqnarray}
%
where $\{ p_l \} = \{p_0,p_1,\ldots,p_{N_p-1}\}$ is a set of $N_p$ parameter
vectors, $p_l\in\RE^{n_{p(l)}}$, $n_p=\sum{n_{p(l)}}$, and $g_j$ are $N_g$
different response functions.  Parameters and response functions are grouped
into different sets for various reasons and the selection and interpretation
of these groups depends on a particular context.  We will not provide an
exhaustive discussion of the motivation for this mathematical form here other
than to say that this is a generalization of the Dakota response model.  The
ModelEvaluator model also supports transient models by supporting the unknowns
$\dot{x}=\frac{dx}{dt}\in\RE^{n_x}$ and $t\in\RE$ but transient models are not
discussed here (see the Trilinos package Rythmos).

The ModelEvaluator interface also allows models to support the computations of
the derivatives

\begin{itemize}

{}\item $\Jac{f}{x}\in\RE^{n_x \times n_x}$,

{}\item $\Jac{f}{p_l}\in\RE^{n_x \times n_{p(l)}}$, for $l=0\ldots{}N_p-1$,

{}\item $\Jac{g_j}{x}\in\RE^{n_{g(j)} \times n_x}$, for $j=0\ldots{}N_g-1$,

{}\item $\Jac{g_j}{p_l}\in\RE^{n_{g(j)} \times n_{p(l)}}$, for
$j=0\ldots{}N_g-1$ and $l=0\ldots{}N_p-1$.

\end{itemize}

The state/state derivative $\jac{f}{x}$ is special since it is a square,
typically invertible, linear operator that allows for the definition of the
implicit state function $x=x(p)$ which must exist in order to compute reduced
derivatives such as shown in (\ref{eqn:red_response_func_deriv}).  It is the
existence $\jac{f}{x}$ that defines a simulation-constrained model.

The ModelEvaluator is a flexible interface and can also be used to represent a
generalized form of the reduced response functions
%
\begin{eqnarray}
(\{ p_l \}) & \rightarrow & \hat{g}_j
\;  \in\RE^{n_p} \rightarrow \RE^{n_{g(j)}},
\; j=0 \ldots N_g-1
\label{eqn:me:red_response_func}
\end{eqnarray}
%
where $\hat{g}_j = g_j(x(\{p_l\}),\{p_l\})$ are the individual reduced
response functions.

A ModelEvaluator object that represents the reduced response functions does so
by encapsulating a nonlinear solver object that eliminates the state variables
and state equations given values of input parameters $\{p_l\}$ (see the class
{}\texttt{Thyra\-::Default\-State\-Elimination\-Model\-Evaluator} in Section
{}\ref{sec:basic_classes}).

The ModelEvaluator interface, the applications modeled using it, and the
algorithms implemented using it, are the key to bridging the intrusive and
non-intrusive realms.

%
\section{Software Plan}
%

Now we can outline the basic software plan for bridging the intrusive realm of
Trilinos and the non-intrusive realm of Dakota.  Here, we will primarily only
consider the handling of steady-state models.  The same basic strategy for
transient models is similar but more complex so we will defer transient models
for later.

%
\subsection{Basic Classes}
\label{sec:basic_classes}
%


{\bsinglespace
\begin{figure}
\begin{center}
%\fbox{
\includegraphics*[angle=270,scale=0.75
]{DakotalinosClassDiagram}
%} %\fbox
\end{center}
\caption{
\label{fig:DakotalinosClassDiagram}
UML class diagram: Basic classes needed to bridge intrusive and non-intrusive
software in Trilinos and Dakota for steady-state simulation-constrained
models.}
\end{figure}
\esinglespace}


Figure {}\ref{fig:DakotalinosClassDiagram} is a UML class diagram that shows
some of the fundamental abstract and concrete classes that are involved in
bridging an underlying application (APP) model (e.g.\ Charon and SIERRA in
this case) and the Dakota non-invasive analysis tools.  In this diagram,
Trilinos is shown as a kind of meta-package (show as a UML package using a
dashed line) meaning to signify that all classes within the Trilinos
meta-package belong to Trilinos packages.  Those classes outside of the
Trilinos meta-package include existing Dakota software and the applications
themselves.  Figure {}\ref{fig:DakotalinosObjectDiagram1} shows an object
diagram for a particular configuration of objects.


{\bsinglespace
\begin{figure}
\begin{center}
%\fbox{
\includegraphics*[angle=270,scale=0.75
]{DakotalinosObjectDiagram1}
%} %\fbox
\end{center}
\caption{
\label{fig:DakotalinosObjectDiagram1}
UML object diagram: A particular configuration of objects involving the APP
Charon, AztecOO for the linear solver, and NOX for the nonlinear solver used
to eliminate the state equations $f(x,p)=0$.}
\end{figure}
\esinglespace}


All of the classes shown in Figure {}\ref{fig:DakotalinosClassDiagram} already
exist and are in current use except for only the one class
{}\textit{Dakota::\-Model\-Evaluator\-Direct\-App}.  The other existing
classes only need minor enhancements in order to fully meet the needs of this
use case (i.e.\ ModelEvaluator software bridging APPs and Dakota).

Some of the more significant classes shown in Figure
{}\ref{fig:DakotalinosClassDiagram} include:

\begin{itemize}

{}\item\textbf{\texttt{\textit{Thyra::ModelEvaluator}}} is an abstract
interface for (\ref{eqn:me:state_func})-(\ref{eqn:me:response_func}) that is
expressed in terms of abstract Thyra objects.  This is the fundamental
interoperability interface for nonlinear models for nonlinear abstract
numerical algorithms (ANA).

{}\item\textbf{\texttt{\textit{EpetraExt::ModelEvaluator}}} is an abstract
interface for (\ref{eqn:me:state_func})-(\ref{eqn:me:response_func}) that
expresses all objects in terms of Epetra objects.  This interface is most
appropriate to be used to derive concrete subclasses to adapt applications
that are already using Epetra or where the developers are comfortable with
Epetra but not Thyra.

{}\item\textbf{\texttt{\textit{Thyra::LinearOpWithSolveFactoryBase}}} (LOWSFB)
is the fundamental abstract interface in Thyra for providing linear solver
capabilities to nonlinear ANAs.  With a LOWSFB object, a client ANA can create
linear solvers (abstracted through the
{}\texttt{\textit{Thyra::\-Linear\-Op\-With\-Solve\-Base}} (LOWSB) interface)
for any compatible forward operator and can then solve linear systems with
various right-hand sides (RHSs).  There are concrete adapters subclasses for
wrapping the Trilinos linear solver packages Amesos, AztecOO, and Belos.
Preconditioners, such as those implemented in the Trilinos packages Ifpack and
ML, are abstracted through the interface
{}\texttt{\textit{Thyra::\-Preconditioner\-Factory\-Base}}.  The Trilinos
package Stratimikos provides a single parameter-list driven interface to
access all of these linear solver and preconditioner capabilities.

{}\item\textbf{\texttt{\textit{Thyra::NonlinearSolverBase}}} is the
fundamental abstract interface in Thyra that allows an ANA client to solve a
nonlinear set of equations $f(x)=0$ expressed as a
{}\texttt{\textit{Thyra\-::Model\-Evaluator}} object.  For example, this is
the interface implicit steppers in Rythmos use to solve nonlinear time-step
equations.

{}\item\textbf{\texttt{\textit{Thyra::NOXNonlinearSolver}}} is a concrete
subclass of {}\texttt{\textit{Thyra::NonlinearSolverBase}} that brings to bear
the NOX nonlinear solver package to solve nonlinear problems presented through
Thyra interfaces.  There are also a few other basic NOX/Thyra adapters classes
needed to make this work but they are not discussed here.

{}\item\textbf{\texttt{Thyra::EpetraModelEvaluator}} is a concrete adapter
subclass that takes a model abstracted through the
{}\texttt{\textit{Epetra\-Ext\-::Model\-Evaluator}} interface and presents it
as a {}\texttt{\textit{Thyra\-::Model\-Evaluator}} object.  A nonsingular
version of the state Jacobian $W=\jac{f}{x}$ is also provided using an
externally configured LOWSFB object.

{}\item\textbf{\texttt{CharonModelEvaluator}} is a concrete subclass of
{}\texttt{\textit{Epetra\-Ext::\-Model\-Evaluator}} that adapts the APP code
Charon.  This class was developed as part of ASC Vertical Integration
Milestone [???] and is testing nightly as part of the daily integration of
Charon + Trilinos Dev [???].

{}\item\textbf{\texttt{sierra:ModelEvaluator}} is a concrete subclass of
{}\texttt{\textit{Epetra\-Ext::\-Model\-Evaluator}} that adapts a SIERRA APP.
This class is currently under heavy development as part of the ASC Outer Core
Algorithm Integration Project with the initial target Aria.

{}\item\textbf{\texttt{Thyra::DefaultStateEliminationModelEvaluator}} is a
concrete {}\texttt{\textit{Thyra\-::Model\-Evaluator}} subclass that uses a
configured {}\texttt{\textit{Thyra\-::Nonlinear\-Solver\-Base}} object to
transform a full simulation-constrained response model
(\ref{eqn:me:state_func})-(\ref{eqn:me:response_func}) into a reduced response
model (\ref{eqn:me:red_response_func}).  This class can also compute analytic
sensitivities of the form (\ref{eqn:red_response_func_deriv}) using direct or
adjoint methods.  This is the fundamental class that converts a
simulation-constrained response model into a form that non-intrusive analysis
methods (such as implemented in Dakota) can use.

{}\item\textbf{\texttt{Dakota::ModelEvaluatorDirectApp}} is a concrete
subclass of the Dakota interface class
{}\texttt{\textit{Dakota\-::Direct\-Fn\-Applic\-Interface}} that adapts a
reduced response model presented as a
{}\texttt{\textit{Thyra\-::Model\-Evaluator}} object into the exact form
needed by Dakota.  This class does not exist yet.

\end{itemize}


%
\subsection{Trilinos Packages and Builder Classes}
%

What Figure {}\ref{fig:DakotalinosClassDiagram} does not show is how the
classes within the Trilinos meta-package are partitioned into actual Trilinos
packages and how these object configurations, such as shown in Figure
{}\ref{fig:DakotalinosObjectDiagram1}, are actually set up.

Figure {}\ref{fig:TrikotaPackageDiagram} shows a package diagram for the
packaging of some of the classes in Figure
{}\ref{fig:DakotalinosClassDiagram}.  This package diagram shows two new
packages that are needed to make this work: {}\texttt{Nonlinear Strategies}
and {}\texttt{Trikota}.


{\bsinglespace
\begin{figure}
\begin{center}
%\fbox{
\includegraphics*[angle=270,scale=0.75
]{TrikotaPackageDiagram}
%} %\fbox
\end{center}
\caption{
\label{fig:TrikotaPackageDiagram}
UML package diagram: Trilinos packages for bridging intrusive and
non-intrusive software in Dakota and Trilinos.  The new Trilinos package
Trikota provides the primary bridge between Dakota and Trilinos.}
\end{figure}
\esinglespace}


The first new Trilinos package is {}\texttt{Nonlinear Strategies}\footnote{We
need a better name than {}\texttt{Nonlinear Strategies}} which will provide
the basic wrappers for exposing reduced response models.  This package will
serve the same role for nonlinear solvers that the package
{}\texttt{Stratimikos} serves for linear solvers and preconditioners.  That
is, the {}\texttt{Nonlinear Strategies} package will provide a convenient
parameter-list driven builder class, called
{}\texttt{Default\-Nonlinear\-Solver\-Builder}, that will take a preformed
ModelEvaluator object for the full steady-state simulation-constrained
response model (\ref{eqn:me:state_func})-(\ref{eqn:me:response_func}) and
convert it into a reduced response model (\ref{eqn:me:red_response_func})
using the class
{}\texttt{Thyra\-::Default\-State\-Elimination\-Model\-Evaluator} and the
classes it depends on.  The {}\texttt{Default\-Nonlinear\-Solver\-Builder}
class will also provide a wrapping of the class
{}\texttt{Stratimikos\-::Default\-Linear\-Solver\-Builder} to provide easy
access to set up linear solvers.  The package {}\texttt{Nonlinear Strategies}
will not depend on Dakota in any way.

The package {}\texttt{Nonlinear Strategies} could also be where transient
solvers in Rythmos are wrapped in order to convert transient
simulation-constrained response models into the reduced response models that
Dakota can handle.  However, converting transient simulation-constrained
response models into reduced response models will be more complicated than in
the steady-state case for several reasons.  However, we will develop the
appropriate ModelEvaluator wrapper classes (some prototypes already exist) and
a parameter-list driven builder class that will help to put together these
reduced response models since this will be a recurring need as we move forward
with Rythmos and transient sensitivity analysis in various applications.

The second new Trilinos package {}\texttt{Trikota} (composed from the names
{}\texttt{Tri-linos} and {}\texttt{Da-kota}) will provide the actual link
between the intrusive realm of Trilinos and the non-intrusive realm of Dakota.
This package will contain the new class
{}\texttt{Dakota::\-Model\-Evaluator\-Direct\-App} and perhaps a default
parameter-list driven builder class to make it easy to wrap a basic
simulation-constrained ModelEvaluator from the underlying APP and build all of
the linear and nonlinear solvers needed to eliminate the state equations in
order to present the reduced response model to Dakota.  The goal would be to
make it extremely easy for APPs to bring Dakota to bear through the
intrusive/non-intrusive link if they already have an appropriate
ModelEvaluator defined for their problem.

In the set up, the actual existing Dakota software would be seen as a
third-party library to Trilinos.  The existing Dakota libraries could be built
completely separately and then pointed to with the compiler and linker
options {}\texttt{-I}, {}\texttt{-L}, and {}\texttt{-l}.  Or, the existing
Dakota software could be built as a library within the Trilinos build system.
This latter approach would have the advantage that Trilinos users would only
have to configure and build Trilinos and then they could get the full power of
Dakota to link in with their application.  Note that the GPL license that
Dakota is distributed under is not 100\% compatible with the LGPL licence that
Trilinos software is distributed under.  The GPL license that is attached to
Dakota will constrain how Dakota can be packaged and used along with Trilinos
but these licensing issues is beyond the scope of this document.

Note that in this set up that there are no circular package dependencies at
all.  In the future, NOX will drop any direct dependence on the package
Epetra, EpetraExt, AztecOO, ML, and Ifpack and instead will only directly
depend on Thyra (this is known as the Dependency Inversion Principle (DIP),
see [???]).  The class {}\texttt{Default\-Nonlinear\-Solver\-Builder} provides
the basic layer to provide NOX the linear solvers that it needs associated
with the nonlinear equation model.


%
\section{Summary}
%

The software plan described above will provide a real tangible link between
the intrusive realm of Trilinos and the non-intrusive realm of Dakota in a way
that will benefit everyone involved.


\begin{SANDdistribution}[NM]
% \SANDdistCRADA	% If this report is about CRADA work
% \SANDdistPatent	% If this report has a Patent Caution or Patent Interest
% \SANDdistLDRD	% If this report is about LDRD work
% External Address Format: {num copies}{Address}
%\SANDdistExternal{}{}
%\bigskip
%% The following MUST BE between the external and internal distributions!
%\SANDdistClassified % If this report is classified
% Internal Address Format: {num copies}{Mail stop}{Name}{Org}
%\SANDdistInternal{}{}{}{}
% Mail Channel Address Format: {num copies}{Mail Channel}{Name}{Org}
%\SANDdistInternalM{}{}{}{}
%\SANDdistInternal{2}{MS 9018}{Central Technical Files}{8944}
%\SANDdistInternal{2}{MS 0899}{Technical Library}{4536}
\end{SANDdistribution}

\end{document}
