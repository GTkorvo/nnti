%
\section{Arguments for adopting a consistent code formatting style}
\label{sec:arguments-for-consistent-style}
%

While there are reasonable ways to handle different code formatting styles
within a project (e.g., custom file styles in emacs), there are arguments for
preferring a more consistent code formatting style that is used throughout a
project by all developers in the project.  It is typically more difficult to
modify code than to read code that uses an unfamiliar coding style and
therefore consistent coding styles is more important in cases where multiple
developers modify the same code base.

One of the more lenient opinions on coding style in the literature comes from
{}\cite[Item 0]{C++CodingStandards05} where the authors state:

\begin{quote}

``Do use consistent formatting within each source file or even each project,
because it's jarring to jump around among several styles in the same piece of
code.  But don't try to enforce consistent formatting across multiple projects
or across a company\footnote{The implicit assumption in this latter
qualification is that developers don't interact heavily with multiple projects
and multiple projects don't interact much with each other and therefore there
is typically little advantage to having a company-wide code formatting
standard.  However, if the same developers work together on multiple projects
and go back and forth between projects frequently, it is unclear what the
opinion of the authors would be in this case.}''.

\end{quote}

Much stronger arguments for working toward a consistent code formatting style
within a project are made by other individuals and organizations who represent
a wide range of views of software development.  These organizations and
persons vary from those associated with open-source organizations (e.g., GNU)
to newer Agile methodologists (e.g., Extreme Programming) to large software
companies (e.g., Microsoft).  As different as these various people and
organizations view the nature of software (e.g., GNU vs.\ Microsoft) and how
it should be developed (e.g., GNU vs.\ Extreme Programming), they all agree
that some consistency in coding style is a good idea.

A few points are worth making before looking at opinions on formatting style
expressed by these different individuals and organizations.  In each of the
references cited, the individual or organization gives a justification for the
opinions expresses and it is up to the reader to weigh these arguments on
their own.  Also, just because an opinion is expressed by an ``expert'' does
not in and of itself automatically give that opinion a lot of credence.
However, when a wide number of different and diverse ``experts'' espouse the
same opinion, then such a point of view should be considered more seriously.


%
\subsection{Statements on coding style from varied persons and/or organizations}
%

Here we overview some options on consistent code formatting style from a
variety of sources.


%
\subsubsection{Open source software (the GNU project)}
%

On one end of the spectrum is the open source software community that one can
think of as the freest form of software.  A GNU package is usually not even
developed by a cohesive set of developers but yet the official GNU Coding
Standard\footnote{{}\texttt{http://www.gnu.org/prep/standards/standards.html}}
states:

\begin{quote}

``The rest of this section gives our recommendations for other aspects of C
formatting style ... We don't think of these recommendations as requirements
... But whatever style you use, please use it consistently, since a mixture of
styles within one program tends to look ugly. If you are contributing changes
to an existing program, please follow the style of that program''.

\end{quote}

While the above passage does not mandate a consistent coding style within a
GNU package (because it can't, its free software), it does recommend a coding
style\footnote{The official GNU formatting style is one of the built-in styles
in Emacs called the ``gnu'' style} and it asks that each project please use a
consistent coding style throughout a GNU project.


%
\subsubsection{Agile Methods (Extreme Programming)}
%

While the Extreme Programming and GNU movements are miles apart in terms of
how it expects coders to work together to create code, they both agree that
using a consistent coding style within a project is important.

In his popular 1999 book ``Extreme Programming Explained''
{}\cite{ExtremeProgrammingExplained99}, Kent Beck explicitly listed ``Coding
Standards'' as one of XP's twelve recommended practices.  In this book, Beck
states

\begin{quote}

``You couldn't possibility ask the team to code to a common standard.
Programmers are deeply individualistic, and would quit rather than put their
curly braces somewhere else. Unless:

\begin{itemize}

{}\item The whole of XP makes them more likely to be members of a winning
team.

\end{itemize}

Then perhaps they could be willing to bend their style a little.  Besides,
without coding standards the additional friction slows pair programming and
refactoring significantly''.

\end{quote}

In this first book, Beck also comments on coding standards in the context of
``collective ownership'' of code by stating:

\begin{quote}

``You couldn't possibly have everybody potentially changing anything anywhere.
Folks would be breaking stuff left and right, and the cost of integration
would go up dramatically.  Unless:

\begin{itemize}

{}\item You integrate after a short enough time, so that chances of conflicts
go down.

{}\item ...

{}\item You adhere to coding standards, so you don't get into the dreaded
Curly Brace Wars.

\end{itemize}

Then perhaps you could have anyone change code anywhere in the system when
they see the chance to improve it''.

\end{quote}

As a result, many XP projects have insisted on requiring every member of the
team to code in the same way.  So much to the point that one should not be
able to tell who wrote a piece of code just in how it is formatted.  As of
this writing, almost every source of information on XP on the Internet takes
a very strong opinion on the adoption of a consistent coding style by an XP
group.  The specific details of the coding style are not important, what is
important is that everyone on the team helps to formulate and agrees to use
the same coding style.

In his updated 2005 book ``Extreme Programming Explained: Second Edition''
{}\cite{ExtremeProgrammingExplained2nd04}, Kent Beck has restructured XP and
now the ``Coding Standards'' practice is no longer specifically listed as a
practice.  Does this mean that consistent code formatting is not longer
important in XP?  The simple answer is no.  In her article ``The New
XP''\footnote{ {}\texttt{http://www.agilexp.org/downloads/TheNewXP.pdf} }
which outlines the second edition of Beck's book and compares it to the first
edition, Michele Marchesi states:

\begin{quote}

``You must note that in the new XP we cannot find original practices of
{}\textit{coding standards}, that is considered obvious, ... ''

\end{quote}

And to put to rest any doubt how Beck himself feels about consistent coding
styles he states in the second edition:

\begin{quote}

``For example, people get passionate about coding style.  While there are
undoubtedly better styles and worse styles, the most important style issue is
that the team chooses to work towards a common style.  Idiosyncratic coding
styles and the values revealed by them, individual freedom at all costs, don't
help the team succeed''.

\end{quote}

Therefore, it is clear that the flagship of the Agile programming movement,
XP, clearly advocates that a team of developers should work towards a
consistent code formatting style.


%
\subsubsection{Code Complete}
%

In {}\cite{CodeComplete2nd04}, Steve McConnell makes a strong argument that
groups should adopt a consistent coding standard, including reasonable
guidelines for the formatting of source code.

There are several places in his book where McConnell stresses the importance
of using a consistent formatting style in a group project:

\begin{itemize}

{}\item ``The bottom line is that the details of a specific method of
structuring a program are much less important than the fact that the program
is structured consistently'' {}\cite[Section 31.1]{CodeComplete2nd04}.  This
quote is almost an exact paraphrase of the statements made in the GNU coding
standard document and by Beck in the Extreme Programming books mentioned
above.

{}\item ``The importance to comprehension and memory of structuring one's
environment in a familiarly way has lead some researchers to hypothesize that
layout might harm an expert's ability to read a program if the layout is
different from the scheme the expert uses (Shell 1981, Soloway and Ehrlich
1984)'' {}\cite[Section 31.1]{CodeComplete2nd04}.  This implies that working
with an unfamiliar style might handicap expert coders more than beginner and
intermediate coders.

{}\item ``Structuring code is important for its own sake.  The specific
convention you follow is less important than the fact that you follow the same
convention consistently'' {}\cite[Chapter 31]{CodeComplete2nd04}.

{}\item ``Many aspects of layout are religious issues.  Try to separate
objective preferences from subjective one.  Use explicit criteria to help
ground your discussions about style preferences.''  {}\cite[Chapter
31]{CodeComplete2nd04}.

{}\item ``Use conventions to spare you brain the challenge of remembering
arbitrary differences between different sections of code .''  {}\cite[Section
34.1]{CodeComplete2nd04}.

{}\item ``The point of having coding conventions is to mainly reduce
complexity.  When you standardized decisions about formatting, loops, variable
names, modeling notations, and so on, you release mental resources that you
need to focus on more challenging aspects of the programming problem.  One
reason coding conventions are so controversial is that choices among the
options have some limited aesthetic base but are essentially arbitrary.  People
have the most heated arguments over their smallest differences.  Conventions
are most useful when they spare you the trouble of making and defending
arbitrary decisions.  They are less valuable when they impose restrictions in
more meaningful areas.''  {}\cite[Section 34.1]{CodeComplete2nd04}.

{}\item ``The motivation behind many programming practices is to reduce a
program's complexity, and reducing complexity is arguably the most important
key to being an effective programmer.''  {}\cite[Chapter
34]{CodeComplete2nd04}.

{}\item ``When abused, a programming convention can be a cure that's worse
than the disease.  Used thoughtfully, a convention adds valuable structure to
the development environment and helps with managing complexity and
communication.''  {}\cite[Chapter 34]{CodeComplete2nd04}.

{}\item ``In general, mandating a strict set of technical standards from the
management position isn't a good idea.''  {}\cite[Section
28.1]{CodeComplete2nd04}.

{}\item ``If someone on a project is going to define standards, have a
respected architect define the standards rather than a manager ... If the
architect is regarded as the projects' thought leader, the project team will
generally follow standards set by that person.''  {}\cite[Section
28.1]{CodeComplete2nd04}.

{}\item ``If your group resists adopting strict standards, consider a few
alternatives: flexible guidelines, a collection of suggestions rather than
guidelines, or a set of examples that embody the best practices.''
{}\cite[Section 28.1]{CodeComplete2nd04}.

{}\item ``Even if your shop hasn't created explicit coding standards, reviews
provide a subtle way of moving toward a group coding standard--decisions are
made by the group during reviews, and over time group derives its own
standards.''  {}\cite[Section 28.1]{CodeComplete2nd04}.

\end{itemize}

One could summarize that McConnell advocates that having a consistent coding
style as being an advantage in many ways but cautions that the standards
should be developed by the programmers in the group and not dictated by
nontechnical managers.


%
\subsubsection{Lockheed Martin Joint Strike Fighter C++ Coding Standard}
%

The {}\textit{Joint Strike Fighter Air Vehicle C++ Coding Standards} document
{}\cite{JSFAVC++CodingStandards2005} from Lockheed Martin defines C++ coding
standards for high consequence applications (i.e.\ the multi-billion dollar
JSF program).  While this standard is not the most strict standard out there,
it does mandate many different aspects of code formatting such as the
placement and indentation of braces '\{\}' (AV Rules 59, 60, and 61) and the
formatting of function prototypes (AV Rule 58).  The point is that standards
for high consequence (i.e.\ low tolerances for defects) may legitimately or
otherwise require greater uniformity in source code.  While some of the
formatting mandates of this document are different than those suggested in
{}\cite[Chapter 31]{CodeComplete2nd04}, this JSF standard in general is
advocated by such individuals as Bjarne Stroustrup
{}\footnote{{}\texttt{http://www.research.att.com/\~{}bs/C++.html}} and is
therefore not without some merit.


%
\subsection{The keyboard analogy for coding styles}
%

The issues involved in going back and forth between different unfamiliar code
formatting styles are similar to the issues in going back and forth between
different computer keyboard layouts.  While some people may naturally prefer
one type of keyboard to another (e.g., such as preferring an ergonomic
keyboard to avoid problems with repetitive stress injuries or people with
larger hands having trouble with smaller keyboards\footnote{Computer mice
layouts show even greater variability than keyboards and going between
different types can hurt productivity even greater.  For example, a standard
mouse could not be more different than a trackball-type of mouse and going
from a standard mouse to a trackball only occasionally can severely degrade
productivity if the individual is unfamiliar with the trackball.}), a person
is most proficient when using a single type of keyboard for a long period of
time.  While a person can generally get used to using a few different types of
keyboards that are used frequently (such as the ergonomic keyboard for a
desktop computer and a smaller laptop keyboard), having to work occasionally
on a very different keyboard really slows down a good typer and increases
typing mistakes.  For example, a person who uses PC-style keyboards with the
Control key on the lower left, are completely handicapped when using a Sun
keyboard where the Control key is where the Caps Lock key is on a PC keyboard.

When given enough time, almost anyone can become accustomed to any reasonable
keyboard layout and can be productive (as long a unusual physical constraints
are not involved).  As long as the person uses the keyboard consistently, the
productivity will be about the same as with a more favored keyboard layout.
Therefore, except for certain physical constraints, a person can learn how to
use most keyboard layouts given enough time, but switching back and forth
occasionally between different keyboards really damages productivity and
increases mistakes.

The same is true for having to read and modify code that uses different code
formatting styles.  Just about anyone can become accustomed to just about any
reasonable coding style if given enough time working with a particular style.
However, switching back and forth frequently between different coding styles
really does damages productivity and increases coding mistakes for some
people, just as switching back and forth between different keyboards can
really damage productivity and increase typing mistakes.


%
\subsection{Conclusions}
%

The antagonism between pushing a common formatting style and allowing for
individual freedom is similar to a system-wide optimization problem that
involves a number of subsystems.  In our case, the subsystems are individual
coders and the whole system is the team as a whole.  Optimizing each subsystem
separately would mean that each developer would own and code a district part
of the overall system.  While this approach maximizes individual developer
productivity, it does not maximize overall productivity in that it discourages
and hinders collective code ownership that has been demonstrated to be highly
effective in the right settings (e.g., Extreme Programming).  On the other
hand, an overly ridged code formatting standard will allow for collective code
ownership but it will also damage the individual productivity of every member
of the team.  Therefore, the ``optimal'' solution to the code formatting
problem is to have the group adopt enough of a uniform style to foster
collective code ownership and speed code reviews, but not to needlessly damage
individual coder productivity.  The balance between these conflicting goals
must be handled with care and only group communication along with experience
and experimentation will yield a near-optimal solution to the code formatting
standards problem for a particular team of developers.

While the above varied sources have different levels of opinions on the
importance on consistent code formatting, they all agree that it is the
developers themselves that should come up with the guidelines, and not
non-technical managers.  They also all seem to agree that a coding standard
that is too ridged will do more harm than good (i.e.\ by damaging the
productivity and moral of individual programmers).

The majority opinion of these experts, therefore, seems to be that a team of
software developers should get together and collectively decide on a
sufficient set of guidelines for code formatting and each member should try to
follow the spirit of the agreed upon style as much as is reasonable while
being allowed to bend or break the guidelines when appropriate.
