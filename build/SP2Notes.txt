I believe I have a solution for your -DSP2 problem
on IBM that Carol described to me.  

This solution assumes the makefile is adding -DSP2
as a preprocessor directive to conditionally compile
some IBM SP2 specific code in the fortran.  As you
noticed, these options have other meanings to xlf.

To pass preprocessor directives with xlf (or its 
variants), you need to add a -WF, before each
directive.  That is change '-DSP2' to '-WF,-DSP2'
on the command line.  

This may solve your problem, but in your example
using az_reorder.f, your code is not actually
getting preprocessed.  On IBM, only .F files are
preprocessed.  This may be the convention your
code is using.  If it is not, and you want the
.f file also preprocessed, you will need to
add '-qsuffix=cpp=f' to the command line.

I hope this resolves your problem.  If not,
please let Carol or me know.
Regards,
-John G.
---------------------------------------------------------------------
John C. Gyllenhaal               Bldg:  451   Rm: 2068
Computation Department           Email: gyllen@llnl.gov
Lawrence Livermore National Lab  Voice: (925) 424-5485
P.O. Box 808, L-561              Fax:   (925) 423-2993
Livermore, CA. 94551-0808        URL: http://www.llnl.gov/sccd/lc/DEG
---------------------------------------------------------------------
