INCLUDE(TribitsAddExecutableAndTest)

INCLUDE_DIRECTORIES(REQUIRED_DURING_INSTALLATION_TESTING ${CMAKE_CURRENT_SOURCE_DIR})

INCLUDE_DIRECTORIES(REQUIRED_DURING_INSTALLATION_TESTING ${CMAKE_CURRENT_SOURCE_DIR}/../Utilities)

IF(PHX_KOKKOS_DEVICE_TYPE_CUDA2)
  IF( TPL_ENABLE_MPI )
      CUDA_INCLUDE_DIRECTORIES( ${MPI_BASE_DIR}/include )
  ENDIF()

  CUDA_INCLUDE_DIRECTORIES( "." )
  CUDA_INCLUDE_DIRECTORIES( ${KokkosCore_INCLUDE_DIRS} 
                            ${Phalanx_INCLUDE_DIRS})
  CUDA_COMPILE( OBJECTS_CUDA tKokkos_CU.cu )
  LIST( APPEND SOURCES ${OBJECTS_CUDA})

 TRIBITS_ADD_EXECUTABLE_AND_TEST(
  tKokkos
  SOURCES ${SOURCES} ${TEUCHOS_STD_UNIT_TEST_MAIN}
  TESTONLYLIBS phalanx_test_utilities
  NUM_MPI_PROCS 1
  )

ELSE()

TRIBITS_ADD_EXECUTABLE_AND_TEST(
  tKokkos
  SOURCES tKokkos.cpp ${TEUCHOS_STD_UNIT_TEST_MAIN}
  TESTONLYLIBS phalanx_test_utilities
  NUM_MPI_PROCS 1
  )
ENDIF()
