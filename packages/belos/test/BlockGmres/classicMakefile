include $(TRILINOS_HOME)/build/TRILINOS_TARGET_DEFS
TRILINOS_TARGET = $(TRILINOS_ARCH).$(TRILINOS_COMM)$(TRILINOS_ID)
include $(TRILINOS_HOME)/build/makefile.$(TRILINOS_TARGET)

DEFINES= -D$(TRILINOS_ARCH) $(EPETRA_ARCH_DEFINES) -D$(EPETRA_COMM) \
          -DIFPACK

INCLUDES = -I../../utils -I../../src $(ARCH_INCLUDES) $(IFPACK_INCLUDES) $(EPETRA_INCLUDES) \
	$(TRIUTILS_INCLUDES)  
  

CFLAGS=$(ARCH_CFLAGS) $(DEFINES) $(INCLUDES)
FFLAGS=$(ARCH_FFLAGS) $(DEFINES) $(INCLUDES)
CXXFLAGS=$(ARCH_CXXFLAGS) $(DEFINES) $(INCLUDES)
CCFLAGS=$(CXXFLAGS)
LDFLAGS=$(ARCH_LDFLAGS)


LIB_PATHS= ../../utils/libbelosutils.$(LIB_EXT) $(LIBIFPACK) $(LIBEPETRA) $(LIBTRIUTILS) \
$(LIBLAPACK) $(LIBY12M) $(LIBBLAS)

#=======================================================================
# Belos test source files
#=======================================================================

TEST_CXX = test_bl_gmres_hb.cpp
PTEST_CXX = test_bl_pgmres_hb.cpp
TEST_C =
PTEST_C =
TEST_F =
PTEST_F =

#=======================================================================
# TEST include files

TEST_INC =

#=======================================================================

TEST_OBJ        = $(TEST_CXX:.cpp=.$(OBJ_EXT)) $(TEST_C:.c=.$(OBJ_EXT)) \
                  $(TEST_F:.f=.$(OBJ_EXT))

PTEST_OBJ        = $(PTEST_CXX:.cpp=.$(OBJ_EXT)) $(PTEST_C:.c=.$(OBJ_EXT)) \
                  $(PTEST_F:.f=.$(OBJ_EXT))
#=======================================================================

TARGET_MPI = bl_gmres_hb_mpi.exe
TARGET_SERIAL = bl_gmres_hb_serial.exe

TARGET = $(TARGET_$(TRILINOS_COMM))

PTARGET_MPI = bl_pgmres_hb_mpi.exe
PTARGET_SERIAL = bl_pgmres_hb_serial.exe

PTARGET = $(PTARGET_$(TRILINOS_COMM))

all: $(TARGET) $(PTARGET)

#=======================================================================

$(TARGET): $(TEST_OBJ)
	$(LINKER) $(LDFLAGS) $(TEST_OBJ) $(LIB_PATHS) $(ARCH_LIBS) \
	$(LIBMPI)  -o $(TARGET)

$(PTARGET): $(PTEST_OBJ)
	$(LINKER) $(LDFLAGS) $(PTEST_OBJ) $(LIB_PATHS) $(ARCH_LIBS) \
	$(LIBMPI)  -o $(PTARGET)

#=======================================================================
# dependencies for 'f' files (none at this time)

#include ../../build/depends.petra

#=======================================================================
clean:
	@echo "junk" > dummy.$(OBJ_EXT)
	@rm -f *.$(OBJ_EXT)  *~ $(TARGET_MPI) $(TARGET_SERIAL) $(PTARGET_MPI) \
				$(PTARGET_SERIAL) 

#=======================================================================
