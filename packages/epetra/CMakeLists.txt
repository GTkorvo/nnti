PROJECT(epetra C CXX Fortran)

# Flag for turning on MPI support
OPTION(ENABLE_MPI 
       "Build with MPI for parallel codes."
       OFF
)

# MPI related configuration
IF(ENABLE_MPI)
  FIND_PACKAGE(MPI)
  IF(DEFINED MPI_LIBRARY AND DEFINED MPI_INCLUDE_PATH)
    SET(HAVE_MPI TRUE)
    INCLUDE_DIRECTORIES(${MPI_INCLUDE_PATH})
    ADD_DEFINITIONS(-DMPICH_IGNORE_CXX_SEEK)
# The following should be set when HAVE_MPI is set
    ADD_DEFINITIONS(-DEPETRA_MPI)
  ELSE(DEFINED MPI_LIBRARY AND DEFINED MPI_INCLUDE_PATH)
    MESSAGE( SEND_ERROR "MPI_LIBRARY and MPI_INCLUDE_PATH must be specified")
    SET(HAVE_MPI FALSE)
  ENDIF(DEFINED MPI_LIBRARY AND DEFINED MPI_INCLUDE_PATH)
ENDIF(ENABLE_MPI)

ADD_SUBDIRECTORY(src)
ADD_SUBDIRECTORY(test)

