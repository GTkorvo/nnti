<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.04 [en] (X11; U; SunOS 4.1.3_U1 sun4m) [Netscape]">
   <TITLE>Zoltan User's Guide:  Library Usage</TITLE>
<!
  ------------------------
  | CVS File Information |
  ------------------------
  $RCSfile$
  $Author$
  $Date$
  $Revision$
>
</HEAD>
<BODY BGCOLOR="#FFFFFF">

<DIV ALIGN=right>
<H3>
<IMG SRC="figures/ug_header.gif" ALT="Zoltan User's Guide" ></H3></DIV>

<H2>
<A NAME="Using the Library"></A>Using the Library</H2>

<H3>
<A NAME="Application Data Types"></A>Application Data Types</H3>
Application query functions and application callable library functions
use global and local identifiers (IDs) for objects. All objects to be used
in load balancing must have unique global IDs. Different applications may
use different data types to represent these IDs. One finite element application,
for example, may use integers as global identifiers (e.g., see [<A HREF="ug_refs.html#mpsalsa">MPSalsa</A>]);
another may use a structure of information including local element counts
and processor numbers (e.g., see [<A HREF="ug_refs.html#alegra">ALEGRA</A>]).
Since the Zoltan library is designed to work with a number of applications,
it must allow applications to specify data types for global and local IDs.The
local IDs passed to the load-balancing library are not used by the library;
they are provided for the convenience of the application and can contain
any information desired by the application. For instance, pointers to objects
may be passed as local IDs, enabling direct access to object data in the
query function routines. See the <A HREF="ug_query.html">application-registered
query functions</A> for more details.To provide data type information to
the load- balancing library, application developers must define their global
and local ID data types in the file "lb/lb_user_const.h" in the Zoltan
library source code distribution. In addition, they must define macros
to copy global and local IDs and to compare global IDs.
When used from Fortran, the IDs and operators are also defined in a module
in fort/lb_user_const.f90, as explained in the section on
<A HREF="ug_fortran_api.html#fortran ug api IDs">Fortran global and local
IDs</A>.  The data and macro
definitions that must be included are described in the <A HREF="#Macro defs">table</A>
below.&nbsp; The source code distribution contains an example in which
global IDs are integers and local IDs are pointers to objects.
<BR>&nbsp;
<TABLE BORDER >
<TR>
<TH><A NAME="Macro defs"></A>Definition</TH>

<TH>Description</TH>
</TR>

<TR>
<TD>LB_GID</TD>

<TD>The data type of the unique global IDs used by the application.</TD>
</TR>

<TR>
<TD>LB_LID</TD>

<TD>The data type of the local IDs used by the application query functions.</TD>
</TR>

<TR>
<TD>LB_SET_GID(<I> a, b</I> )</TD>

<TD>Assigns the global ID value in <I>b</I> to <I>a</I> (i.e., <I>a = b</I>
).</TD>
</TR>

<TR>
<TD>LB_SET_LID(<I> a, b</I> )</TD>

<TD>Assigns the local ID value in <I>b</I> to <I>a</I> (i.e., <I>a = b</I>
).</TD>
</TR>

<TR>
<TD>LB_EQ_GID(<I> a, b</I> )</TD>

<TD>Returns TRUE if global IDs <I>a</I> and <I>b</I> are equal; returns
FALSE otherwise.</TD>
</TR>

<TR>
<TD>LB_NE_GID(<I> a, b)</I></TD>

<TD>Returns TRUE if global IDs <I>a</I> and <I>b</I> are not equal; returns
FALSE otherwise.</TD>
</TR>

<TR>
<TD>LB_LT_GID(<I> a, b</I> )</TD>

<TD>Returns TRUE if global ID <I>a</I> is less than global ID <I>b</I>
; returns FALSE otherwise.</TD>
</TR>

<TR>
<TD>LB_LE_GID(<I> a, b</I> )</TD>

<TD>Returns TRUE if global ID <I>a</I> is less than or equal to global
ID <I>b</I> ; returns FALSE otherise.</TD>
</TR>

<TR>
<TD>LB_GT_GID(<I> a, b</I> )</TD>

<TD>Returns TRUE if global ID <I>a</I> is greater than global ID <I>b</I>
; returns FALSE otherwise.</TD>
</TR>

<TR>
<TD>LB_GE_GID(<I> a, b</I> )</TD>

<TD>Returns TRUE if global ID <I>a</I> is greater than or equal to global
ID <I>b</I> ; returns FALSE otherwise.</TD>
</TR>

<CAPTION ALIGN=BOTTOM><I>Data type and macro definitions that must be provided
to the load-balancing library by the application in lb/lb_user_const.h.</I></CAPTION>
</TABLE>

<H3>
<A NAME="Building the Library"></A>Building the Library</H3>
The Zoltan library is implemented in ANSI C and can be compiled with any
ANSI C compiler.&nbsp; Example Makefiles are included with the source code.
The top-level Makefile includes targets for several architectures, including
Sandia's ASCI Red computer and Intel Paragon. Dependency and object files
and the resulting load-balancing library file are placed in subdirectories
for each architecture. Thus, to build the library for Sandia's ASCI Red
computer, a user types
<BLOCKQUOTE>gmake [options] tflop</BLOCKQUOTE>
where the options that may be specified are listed below.
<TABLE WIDTH="100%" >
<TR>
<TD WIDTH="20%"><B>Options to gmake:</B></TD>

<TD>&nbsp;</TD>
</TR>

<TR>
<TD VALIGN=TOP><I>&nbsp;&nbsp;&nbsp; NO_PARMETIS=1</I></TD>

<TD>Do not compile and link with <A HREF="ug_alg_parmetis.html">ParMETIS</A>
in the Zoltan library.&nbsp; If this option is specified, no <A HREF="ug_alg_parmetis.html">ParMETIS</A> libraries
are needed when the application is linking.&nbsp; Otherwise, a <A HREF="ug_alg_parmetis.html">ParMETIS</A>
library path must be specified to <A HREF="#Building Applications">build
the application</A>.</TD>
</TR>

<TR>
<TD VALIGN=TOP><I>&nbsp;&nbsp;&nbsp; YES_FORTRAN=1</I></TD>

<TD>Include Fortran support in the Zoltan library.&nbsp;  By default, the
Zoltan library is built without the interface that allows use from Fortran
applications.&nbsp; If this option is specified, then the
<A HREF="ug_fortran.html">Fortran interface</A>
is compiled and included in the library.&nbsp;  Use of this option requires that
a Fortran 90 (or 95, or later) compiler is available.</TD>
</TR>
</TABLE>
The resulting library is stored in Obj_tflop/libzoltan.a. Paths within
the top-level Makefile and the Makefiles in the Obj_* subdirectories may
have to be changed for the user's computing environment.
<H3>
<A NAME="Building Applications"></A>Building Applications</H3>
The library interface is described in the C include file "lbi_const.h";
this file should be included in all application source files that call
Zoltan library routines.  Similarly, Fortran applications must USE
<A HREF="ug_fortran_api.html#fortran ug api zoltan module"> module
zoltan</A>.  The application should then be linked with the
Zoltan library by including -lzoltan in the linking command for the application.
Communication within the library is performed through MPI, so appropriate
MPI libraries must be linked with the application. If the <I>NO_PARMETIS=1
</I>parameter was not specified when Zoltan was compiled, <A HREF="ug_alg_parmetis.html">ParMETIS</A>
libraries -lparmetis and -lmetis must also be included in the application's
linking command.
<A HREF="ug_fortran_apps.html">Compiling Fortran applications</A> also
requires specifying fort/ as a directory to be searched for module information
files.
<BR>&nbsp;

<P>
<HR WIDTH="100%">[<A HREF="ug.html">Table of Contents</A>&nbsp; |&nbsp;
<A HREF="ug_interface.html">Next:&nbsp; Zoltan Interface Functions</A>&nbsp;
|&nbsp; <A HREF="ug_intro.html">Previous: Introduction</A>]
</BODY>
</HTML>
