<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.7 [en] (X11; U; SunOS 5.7 sun4u) [Netscape]">
   <meta name="sandia.approved" content="SAND99-1377">
   <meta name="author" content="karen devine, kddevin@sandia.gov">
   <title>Zoltan User's Guide:  Library Usage</title>
<!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 ! Zoltan Dynamic Load-Balancing Library for Parallel Applications            !
 ! Copyright (c) 2000, Sandia National Laboratories.                          !
 ! Zoltan is distributed under the GNU Lesser General Public License 2.1.     !
 ! For more info, see the README file in the top-level Zoltan directory.      ! 
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
>
<! CVS File Information
     $RCSfile$
     $Author$
     $Date$
     $Revision$
>
</head>
<body bgcolor="#FFFFFF">

<div ALIGN=right><b><i><a href="ug.html">Zoltan User's Guide</a>&nbsp; |&nbsp; <a href="ug_interface.html">Next</a>&nbsp; |&nbsp; <a href="ug_intro.html">Previous</a></i></b></div>


<h2>
<a NAME="Using the Library"></a>Using the Zoltan library</h2>
This section contains information needed to use the Zoltan library with
applications:
<blockquote><a href="#Application Data Types">Application data type</a>s
for global and local IDs
<br>Instructions for <a href="#Building the Library">building the Zoltan
library</a>
<br>Instructions for <a href="#Building Applications">building applications</a>
that use Zoltan.</blockquote>

<h3>
<a NAME="Application Data Types"></a>Application Data Types</h3>
Application query functions and application callable library functions
use global and local identifiers (IDs) for objects. All objects to be used
in load balancing must have unique global IDs. Different applications may
use different data types to represent these IDs. One finite element application,
for example, may use integers as global identifiers (e.g., see [<a href="ug_refs.html#mpsalsa">MPSalsa</a>]);
another may use a structure of information including local element counts
and processor numbers (e.g., see [<a href="ug_refs.html#alegra">ALEGRA</a>]).
Since the Zoltan library is designed to work with a number of applications,
it must allow applications to specify data types for global and local IDs.The
local IDs passed to the load-balancing library are not used by the library;
they are provided for the convenience of the application and can contain
any information desired by the application. For instance, pointers to objects
may be passed as local IDs, enabling direct access to object data in the
query function routines. See the <a href="ug_query.html">application-registered
query functions</a> for more details.To provide data type information to
the load- balancing library, application developers must define their global
and local ID data types in the file "lb/lb_user_const.h" in the Zoltan
library source code distribution. In addition, they must define macros
to copy global and local IDs and to compare global IDs. When used from
Fortran, the IDs and operators are also defined in a module in fort/lb_user_const.f90,
as explained in the section on
<a href="ug_fortran_api.html#fortran ug api IDs">Fortran
global and local IDs</a>. The data and macro definitions that must be included
are described in the <a href="#Macro defs">table</a> below.&nbsp; The source
code distribution contains an example in which global IDs are integers
and local IDs are pointers to objects.
<br>&nbsp;
<table BORDER >
<tr>
<th><a NAME="Macro defs"></a>Definition</th>

<th>Description</th>
</tr>

<tr>
<td>LB_GID</td>

<td>The data type of the unique global IDs used by the application.</td>
</tr>

<tr>
<td>LB_LID</td>

<td>The data type of the local IDs used by the application query functions.</td>
</tr>

<tr>
<td>LB_SET_GID(<i> a, b</i> )</td>

<td>Assigns the global ID value in <i>b</i> to <i>a</i> (i.e., <i>a = b</i>
).</td>
</tr>

<tr>
<td>LB_SET_LID(<i> a, b</i> )</td>

<td>Assigns the local ID value in <i>b</i> to <i>a</i> (i.e., <i>a = b</i>
).</td>
</tr>

<tr>
<td>LB_EQ_GID(<i> a, b</i> )</td>

<td>Returns TRUE if global IDs <i>a</i> and <i>b</i> are equal; returns
FALSE otherwise.</td>
</tr>

<tr>
<td>LB_NE_GID(<i> a, b)</i></td>

<td>Returns TRUE if global IDs <i>a</i> and <i>b</i> are not equal; returns
FALSE otherwise.</td>
</tr>

<tr>
<td>LB_LT_GID(<i> a, b</i> )</td>

<td>Returns TRUE if global ID <i>a</i> is less than global ID <i>b</i>
; returns FALSE otherwise.</td>
</tr>

<tr>
<td>LB_LE_GID(<i> a, b</i> )</td>

<td>Returns TRUE if global ID <i>a</i> is less than or equal to global
ID <i>b</i> ; returns FALSE otherise.</td>
</tr>

<tr>
<td>LB_GT_GID(<i> a, b</i> )</td>

<td>Returns TRUE if global ID <i>a</i> is greater than global ID <i>b</i>
; returns FALSE otherwise.</td>
</tr>

<tr>
<td>LB_GE_GID(<i> a, b</i> )</td>

<td>Returns TRUE if global ID <i>a</i> is greater than or equal to global
ID <i>b</i> ; returns FALSE otherwise.</td>
</tr>

<caption ALIGN=BOTTOM><i>Data type and macro definitions that must be provided
to the load-balancing library by the application in lb/lb_user_const.h.</i></caption>
</table>

<h3>
<a NAME="Building the Library"></a>Building the Zoltan Library</h3>
The Zoltan library is implemented in ANSI C and can be compiled with any
ANSI C compiler.&nbsp; Makefiles are included with the source code. The
top-level Makefile defines targets for the Zoltan library and <a href="../dev_html/dev_driver.html">test
driver</a> programs in C and Fortran90.&nbsp; This Makefile need not be
edited to build Zoltan.&nbsp; Instead, environment-specific definitions
are specified in the lower-level makefile, <i>Makefiles/Makefile.&lt;platform></i>,
where <i>&lt;platform></i> specifies the particular platform for which
Zoltan is being built.&nbsp; Paths to compilers, include files, and libraries
are defined in this lower-level makefile and are then read by the top-level
Makefile.&nbsp; Examples of lower-level makefiles for Solaris, Sandia's
ASCI Red (tflop) computer, an Intel Paragon, and Linux boxes are included
in the <i>Makefiles</i> subdirectory.&nbsp;&nbsp; A well-commented version
of the lower-level makefile, <i>Makefiles/Makefile.generic</i>, is also
included; this file can be used as a template for new environment-specific
makefiles.&nbsp; The variables in these files should be edited to reflect
the new system's environment.
<p>The command for building Zoltan is shown below:
<blockquote>gmake [options] zoltan</blockquote>
where the options that may be specified are listed below.
<table WIDTH="100%" >
<tr>
<td WIDTH="20%"><b>Options to gmake:</b></td>

<td>&nbsp;</td>
</tr>

<tr>
<td VALIGN=TOP><i>&nbsp;&nbsp;&nbsp; ZOLTAN_ARCH=&lt;platform></i></td>

<td>Specify the target architecture for the Zoltan library.&nbsp; A corresponding
file, <i>Makefiles/Makefile.&lt;platform></i>, containing environment definitions
for <i>&lt;platform</i>>, must be created in the
<i>Makefiles</i> directory.</td>
</tr>

<tr>
<td VALIGN=TOP><i>&nbsp;&nbsp;&nbsp; YES_FORTRAN=1</i></td>

<td>Include Fortran support in the Zoltan library.&nbsp; By default, the
Zoltan library is built without the interface that allows use from Fortran
applications.&nbsp; If this option is specified, the
<a href="ug_fortran.html">Fortran
interface</a> is compiled and included in the library.&nbsp; Use of this
option requires that a Fortran 90 (or 95, or later) compiler is available.</td>
</tr>
</table>
As an alternative to typing the options on the gmake command line, they
may be set as environment variables; e.g.,
<blockquote>setenv ZOLTAN_ARCH <i>&lt;platform></i></blockquote>
The resulting library <i>libzoltan.a</i>, object files, and dependency
files are stored in the directory Obj_&lt;<i>platform</i>>.
<h3>
<a NAME="Building Applications"></a>Building Applications that use Zoltan</h3>
The library interface is described in the C include file "lbi_const.h";
this file should be included in all application source files that call
Zoltan library routines. Similarly, Fortran applications must USE
<a href="ug_fortran_api.html#fortran ug api zoltan module">module
zoltan</a>. The application should then be linked with the Zoltan library
by including -lzoltan in the linking command for the application. Communication
within the library is performed through MPI, so appropriate MPI libraries
must be linked with the application. Third-party libraries, such as <a href="ug_alg_parmetis.html">ParMETIS</a>
and <a href="http://www.gre.ac.uk/~jjg01/">Jostle</a>, must be also be
linked with the application if they were included in compilation of the
Zoltan library.&nbsp; In Zoltan's top-level <a href="#Building the Library">Makefile</a>,
the variable $THIRD_PARTY_LIBS&nbsp; specifies the library names that can
be used with Zoltan.&nbsp; <a href="ug_fortran_apps.html">Compiling Fortran
applications</a> also requires specifying<i> Zoltan/Obj_&lt;platform></i>
as a directory to be searched for module information files.
<br>&nbsp;
<p>
<hr WIDTH="100%">[<a href="ug.html">Table of Contents</a>&nbsp; | <a href="ug_interface.html">Next:&nbsp;
Zoltan Interface Functions</a>&nbsp; |&nbsp; <a href="ug_intro.html">Previous:
Introduction</a>]
</body>
</html>
