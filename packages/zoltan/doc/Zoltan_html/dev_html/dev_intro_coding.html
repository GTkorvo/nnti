<!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 ! Zoltan Dynamic Load-Balancing Library for Parallel Applications            !
 ! Copyright (c) 2000, Sandia National Laboratories.                          !
 ! Zoltan is distributed under the GNU Lesser General Public License 2.1.     !
 ! For more info, see the README file in the top-level Zoltan directory.      ! 
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
>
<! CVS File Information
     $RCSfile$
     $Author$
     $Date$
     $Revision$
>

<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.04 [en] (X11; U; SunOS 5.6 sun4m) [Netscape]">
   <META NAME="sandia.approved" CONTENT="SAND99-1376">
   <META NAME="author" CONTENT="karen devine, kddevin@sandia.gov">

   <TITLE> Zoltan Developer's Guide:  Coding Principles</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">

<div ALIGN=right><b><i><a href="dev.html">Zoltan Developer's Guide</a>&nbsp; |&nbsp; <a href="dev_dist.html">Next</a>&nbsp; |&nbsp; <a href="dev_intro_philosophy.html">Previous</a></i></b></div>


<H2>
<A NAME="coding"></A>Coding Principles in Zoltan</H2>

<H3>
<A NAME="include"></A>Include files</H3>
Include files should be used for function prototypes, global variable definitions,
and data structure definitions. The convention used is that external function
prototypes, external global variable definitions, and data structure definitions
required by more than one source file are stored in include files named
<I>*_const.h</I> (e.g., <I>lb/lb_const.h</I>). Include files with static
function prototypes, global variable declarations, or static data structure
definitions (i.e., files that are included in only one source file) are
named <I>*.h</I> (e.g.,<I> lb/lb.h</I>).

<P>The include file <I>lb/lbi_const.h</I> contains the load-balancing library
interface; it should be included by application source files that call
the load-balancing library. The include file <I>lb/lb_const.h</I> describes
the principle load-balancing data structures. As these data structures
are used heavily by the load-balancing algorithms, <I>lb/lb_const.h</I>
should be included in most source files of the load-balancing library.
<BR>&nbsp;
<H3>
<A NAME="global"></A>Global variables</H3>
The use of global variables is highly discouraged in the load-balancing
library. In limited cases, static global variables can be tolerated within
a source file of an algorithm. However, developers should keep in mind
that several load-balancing structures may be used by an application, with
each structure using the same algorithm. Thus, global variables set by one
instance of load balancing may be reset by other instances, causing errors
in the algorithms. Global variable names may also conflict with variables
used elsewhere in the library or application, causing unintended side-effects
and complicating debugging. For greatest robustness, developers are asked
NOT to use global variables in their algorithms. See <A HREF="dev_add_struct.html">Data
Structures</A> for ideas on avoiding the use of global variables.
<BR>&nbsp;
<H3>
<A NAME="par_comm"></A>Parallel Communication</H3>
All communication in the Zoltan library should be performed through MPI
communication routines. The MPI interface was chosen to enable portability
to many different platforms. It will be especially important as the code
is extended to heterogeneous computing systems.

<P>Some useful communication utilities are provided within the library
to perform irregular communication and synchronization. See <A HREF="dev_util_comm.html">Irregular
Communication Library</A> and <A HREF="dev_util_parallel.html">Parallel
Computing</A>.
<BR>&nbsp;
<H3>
<A NAME="memory1"></A>Memory Management</H3>
It is strongly suggested that all memory allocation in the library is handled
using the functions supplied in <I>all/all_allo.c</I>. Use of these functions
will make debugging and maintenance of the library much easier as the library
gets larger. See <A HREF="dev_util_mem.html">Memory Management</A> for
information on the memory management utilities.
<BR>&nbsp;
<H3>
<A NAME="return"></A>Errors &amp; Return Codes</H3>
If an error occurs in the Zoltan library, a message should be printed to
stderr, all memory allocated in the current function should be freed, and
an error code should be returned. The Zoltan library should never exit.
Control should always be returned to the application with an error code.
The error codes are defined in the <A HREF="#error codes table">table</A>
below.
<BR>&nbsp;
<CENTER><TABLE BORDER WIDTH="90%" >
<TR>
<TD VALIGN=TOP><I>LB_OK</I></TD>

<TD ALIGN=LEFT>No warnings or errors occurred.</TD>
</TR>

<TR>
<TD VALIGN=TOP><I>LB_WARN&nbsp;</I></TD>

<TD>A warning was encountered during execution. The application should
be able to continue to run.</TD>
</TR>

<TR>
<TD VALIGN=TOP><I>LB_FATAL&nbsp;</I></TD>

<TD>A fatal error occured in the library.</TD>
</TR>

<TR>
<TD VALIGN=TOP><I>LB_MEMERR</I></TD>

<TD>An error occurred while allocating memory. When this error occurs,
the library frees any allocated memory and returns control to the application.
If the application then wants to try to use another, less memory-intensive,
algorithm, it can do so.</TD>
</TR>

<CAPTION ALIGN=BOTTOM><A NAME="error codes table"></A><I>Return codes defined
in lb/lbi_const.h.</I></CAPTION>
</TABLE></CENTER>
Currently, this philosophy is not being strictly followed in the code.
Efforts will be made to bring existing code up-to-date, and to follow this
rule in all future development.
<BR>&nbsp;
<H3>
<A NAME="functions"></A>Function Names</H3>
In order to avoid name conflicts with applications and other libraries,
all functions should be prepended with <B>LB_</B><I>.</I>&nbsp; As a general
rule, each new word in a function name should be capitalized (for example,
LB_Help_Migrate). Internal Zoltan functions do not have to follow these rules.

<P>
<HR WIDTH="100%">
<BR>[<A HREF="dev.html">Table of Contents</A>&nbsp; |&nbsp; <A HREF="dev_dist.html">Next:&nbsp;
Zoltan Distribution</A>&nbsp; |&nbsp; <A HREF="dev_intro_philosophy.html">Previous:&nbsp;
Philosophy</A>]
</BODY>
</HTML>
