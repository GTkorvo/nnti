<!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 ! Zoltan Dynamic Load-Balancing Library for Parallel Applications            !
 ! Copyright (c) 2000, Sandia National Laboratories.                          !
 ! Zoltan is distributed under the GNU Lesser General Public License 2.1.     !
 ! For more info, see the README file in the top-level Zoltan directory.      ! 
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
>
<! CVS File Information
     $RCSfile$
     $Author$
     $Date$
     $Revision$
>

<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.04 [en] (X11; U; SunOS 4.1.3_U1 sun4m) [Netscape]">
   <META NAME="sandia.approved" CONTENT="SAND99-1376">
   <META NAME="author" CONTENT="karen devine, kddevin@sandia.gov">

   <TITLE> Zoltan Developer's Guide:  Parallel Utilities</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">

<div ALIGN=right><b><i><a href="dev.html">Zoltan Developer's Guide</a>&nbsp; |&nbsp; <a href="dev_util_hash.html">Next</a>&nbsp; |&nbsp; <a href="dev_util_comm.html">Previous</a></i></b></div>


<H2>
<A NAME="parallel_compute"></A>Parallel Computing Utilities</H2>
Parallel computing utilities are described in this section.
<BLOCKQUOTE><B><A HREF="#LB_Print_Sync_Start">LB_Print_Sync_Start</A></B>
/ <B><A HREF="#LB_Print_Sync_End">LB_Print_Sync_End</A></B>:&nbsp; provide
synchronization of processors for I/O (with <A HREF="#print_sync_example">example</A>).
<BR><B><A HREF="#LB_Print_Stats">LB_Print_Stats</A></B> : print statistics
about a parallel variable.</BLOCKQUOTE>

<HR><A NAME="LB_Print_Sync_Start"></A>void <B>LB_Print_Sync_Start</B>(struct
<B><A HREF="dev_lb_structs.html#LB_Struct">LB_Struct</A></B> *<I>lb</I>,
int <I>do_print_line</I>);&nbsp;
<HR>

<P>The <B>LB_Print_Sync_Start</B> function is adapted from work of John
Shadid for the MPSalsa project at Sandia National Laboratories. With <B><A HREF="#LB_Print_Sync_End">LB_Print_Sync_End</A></B>,
it provides synchronization so that one processor in the load-balancing
communicator can complete its I/O before the next processor begins its
I/O. This synchronization utility is useful for debugging algorithms, as
it allows the output from processors to be produced in an organized manner.
It is, however, a serializing process, and thus, does not scale well to
large number of processors.

<P><B>LB_Print_Sync_Start</B> should called by each processor in the MPI
communicator before the desired I/O is performed. <B><A HREF="#LB_Print_Sync_End">LB_Print_Sync_End</A></B>
is called by each processor after the I/O is performed. No communication
can be performed between calls to <B>LB_Print_Sync_Start</B> and <B><A HREF="#LB_Print_Sync_End">LB_Print_Sync_End</A></B>.
See the <A HREF="#print_sync_example">example</A> below for usage <B>LB_Print_Sync_Start</B>.
<BR>&nbsp;
<TABLE WIDTH="100%" >
<TR VALIGN=TOP>
<TD VALIGN=TOP WIDTH="20%"><B>Parameters:</B></TD>

<TD></TD>
</TR>

<TR>
<TD VALIGN=TOP>&nbsp;&nbsp;&nbsp; <I>lb</I></TD>

<TD>The load-balancing data structure used in the invocation of the load-balancing
routines.</TD>
</TR>

<TR>
<TD VALIGN=TOP>&nbsp;&nbsp;&nbsp; <I>do_print_line</I></TD>

<TD>A flag indicating whether to print a line of "#" characters before
and after the synchronization block. If <I>do_print_line</I> is TRUE, a
line is printed; no line is printed otherwise.</TD>
</TR>
</TABLE>
&nbsp;

<P>
<HR><A NAME="LB_Print_Sync_End"></A>void <B>LB_Print_Sync_End</B>(struct
<B><A HREF="dev_lb_structs.html#LB_Struct">LB_Struct</A></B> *<I>lb</I>,
int <I>do_print_line</I>);&nbsp;
<HR>

<P>The <B>LB_Print_Sync_End </B>function is adapted from work of John Shadid
for the MPSalsa project at Sandia National Laboratories. With <B><A HREF="#LB_Print_Sync_Start">LB_Print_Sync_Start</A></B>,
it provides synchronization so that one processor in the load-balancing
communicator can complete its I/O before the next processor begins its
I/O. This synchronization utility is useful for debugging algorithms, as
it allows the output from processors to be produced in an organized manner.
It is, however, a serializing process, and thus, does not scale well to
large number of processors.

<P><B><A HREF="#LB_Print_Sync_Start">LB_Print_Sync_Start</A></B> should
called by each processor in the MPI communicator before the desired I/O
is performed. <B>LB_Print_Sync_End</B> is called by each processor after
the I/O is performed. No communication can be performed between calls to
<B><A HREF="#LB_Print_Sync_Start">LB_Print_Sync_Start</A></B> and <B>LB_Print_Sync_End</B>.
See the <A HREF="#print_sync_example">example</A> below for usage of <B>LB_Print_Sync_End</B>.
<BR>&nbsp;
<TABLE WIDTH="100%" >
<TR VALIGN=TOP>
<TD VALIGN=TOP WIDTH="20%"><B>Parameters:</B></TD>

<TD></TD>
</TR>

<TR>
<TD VALIGN=TOP>&nbsp;&nbsp;&nbsp; <I>lb</I></TD>

<TD>The load-balancing data structure used in the invocation of the load-balancing
routines.</TD>
</TR>

<TR>
<TD VALIGN=TOP>&nbsp;&nbsp;&nbsp; <I>do_print_line</I></TD>

<TD>A flag indicating whether to print a line of "#" characters before
and after the synchronization block. If <I>do_print_line</I> is TRUE, a
line is printed; no line is printed otherwise.</TD>
</TR>
</TABLE>
&nbsp;
<HR WIDTH="100%"><A NAME="LB_Print_Stats"></A>void <B>LB_Print_Stats</B>(struct
LB_Struct *lb, double x, char *msg);
<BR>
<HR WIDTH="100%">
<BR>LB_Print_Stats is a very simple routine that computes the maximum and
sum of the variable <I>x</I> over all processors associated with the load-balancing
structure <I>lb</I>. It also computes and prints&nbsp; the&nbsp; imbalance
of <I>x</I>, that is, the maximum value divided by the average minus one.
If <I>x </I>has the same value on all processors, the imbalance is zero.

<P>&nbsp;<B>Parameters:</B>
<BR>&nbsp;
<TABLE BORDER=0 WIDTH="100%" NOSAVE >
<TR>
<TD>&nbsp;&nbsp;&nbsp; <I>lb&nbsp;</I></TD>

<TD>The load-balancing data structure used in the invocation of the load-balancing
routines.</TD>
</TR>

<TR>
<TD>&nbsp;&nbsp;&nbsp; <I>x</I></TD>

<TD>The variable of which one wishes to display statistics.</TD>
</TR>

<TR NOSAVE>
<TD>&nbsp;&nbsp;&nbsp; <I>msg</I></TD>

<TD NOSAVE>A string that typically describes the meaning of <I>x.</I></TD>
</TR>
</TABLE>

<HR WIDTH="100%">
<H4>

<HR WIDTH="100%"><A NAME="print_sync_example"></A><B>Example Using LB_Print_Sync_Start/LB_Print_Sync_End</B></H4>
&nbsp;
<CENTER><TABLE BORDER=2 COLS=1 WIDTH="90%" NOSAVE >
<TR>
<TD><TT>...</TT>&nbsp;
<BR><TT>if (lb->Debug > 6) {</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; int i;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; LB_Print_Sync_Start(lb, TRUE);</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; printf("LBLB: Objects to be exported from Proc
%d\n", lb->Proc);</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; for (i = 0; i &lt; *num_export_objs; i++) {</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("&nbsp;&nbsp;&nbsp;
Obj: %10d&nbsp; Destination: %4d\n",</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(*export_global_ids)[i], (*export_procs)[i]);</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; }</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; LB_Print_Sync_End(lb, TRUE);</TT>&nbsp;
<BR><TT>}</TT></TD>
</TR>

<CAPTION ALIGN=BOTTOM><I>Example usage of LB_Print_Sync_Start and LB_Print_Sync_End
to synchronize output among processors.&nbsp; (Taken from LB_Balance in
lb/lb.c.)</I></CAPTION>
</TABLE></CENTER>
&nbsp;

<P>
<HR WIDTH="100%">
<BR>[<A HREF="dev.html">Table of Contents</A>&nbsp; |&nbsp; <A HREF="dev_util_hash.html">Next:&nbsp;
Hash Function</A>&nbsp; |&nbsp; <A HREF="dev_util_comm.html">Previous:&nbsp;
Irregular Communication Library</A>]
</BODY>
</HTML>
