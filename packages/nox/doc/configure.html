<html>
<!--
@HEADER
# ************************************************************************
# 
#            NOX: An Object-Oriented Nonlinear Solver Package
#                 Copyright (2002) Sandia Corporation
# 
# Under terms of Contract DE-AC04-94AL85000, there is a non-exclusive
# license for use of this work by or on behalf of the U.S. Government.
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2, or (at your option)
# any later version.
#   
# This program is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# General Public License for more details.
#   
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
# 
# Questions? Contact Tammy Kolda (tgkolda@sandia.gov) or Roger Pawlowski
# (rppawlo@sandia.gov).
# 
# ************************************************************************
@HEADER
-->

<head>
<title>NOX Configuration Instructions</title>
</head>
<body bgcolor="white">
<h1>NOX Configuration Instructions</h1>

<h3>Basic Setup</h3>

<P>To just compile the basic NOX library, type
<blockquote>
<code>
configure<br>
make
</code>
</blockquote>
This only compiles the library <code>libnox.a</code>
- it does not build any of the
examples. See below for more information on compiling the examples.

<h3>Generating Documentation</h3>

<P>After running configure, type 
<blockquote>
<code>
make dox
</code>
</blockquote>
<p>to generate the documentation.</p>

<p>Once the documentation is generated, you should be able to access
it by <a href="html/index.html">clicking here</a>.</p>

<h3>Compiling the examples</h3>

NOX is distributed with a simple set of examples that have no other
external dependencies besides LAPACK. These are primarily useful to
allow some basic testing of NOX without requiring an interface to a
more complicated linear algebra system. To enable these examples, type

<blockquote>
<code>
configure --enable-examples<br>
make
</code>
</blockquote>

The compiled examples are located in the <code>examples</code>
subdirectory.  To run each example, follow the instructions given below.

<ol>
<li>To run a simple 2D example based on the Rosenbrock function, type
<blockquote>
<code>
rosenbrock
</code>
</blockquote>
<li><em>More examples to come...</em>
</ol>

<h3>Using PETSc With NOX</h3>

To use NOX's interface to pre-built Petsc libraries, follow the instructions 
given below.

<h5>Building the library</h5>

<p>To compile NOX's Petsc library <code>libnoxpetsc.a</code>, use 
the following configuration option.</p>
<ul>
<li><code>configure --enable-petsc</code>
<p>This will automatically use the environmental variables 
<code>PETSC_DIR</code> and <code>PETSC_ARCH</code> 
to find the necessary headers.</p>
For example, to build <code>libnoxpetsc.a</code> using a pre-built PETSc
version 2.1.3 installed in the user's home directory on a linux machine:
<ul>
<li><code>setenv PETSC_DIR ${HOME}/petsc-2.1.3</code>
<li><code>setenv PETSC_ARCH linux</code>
<li><code>nox/configure --enable-petsc</code>
</ul>
</ul>


<h5>Building the Petsc Examples</h5>

To compile the examples for NOX-Petsc, an additional environment variable,
PETSC_BOPT, must be defined and set to the value of BOPT used to build the 
user's PETSc installation.  For example, for a debug-enabled C++ PETSc build, 
BOPT=g_c++ so that PETSC_BOPT=g_c++.  The configure script then allows
the examples to be built using the following:
<blockquote>
<li><code>configure --enable-petsc --enable-petsc-examples</code>.
</blockquote>
</ul>

Depending on the user's PETSc build, dynamically linked libraries may be used.
If an error occurs when trying to run the example executable, make sure the
environment variable LD_LIBRARY_PATH points to the PETSc library directory.
From the example above, setting the path would likely require:
<ul>
<li><code>setenv LD_LIBRARY_PATH ${PETSC_DIR}/lib/lib${PETSC_BOPT}/${PETSC_ARCH}</code>
</ul>


<h3>Using Epetra/Trilinos With NOX</h3>

To use NOX's interface to the Epetra and AztecOO libraries in
Trilinos, follow the instructions given below.

<h5>Building the library</h5>

<p>To compile NOX's Epetra library <code>libnoxepetra.a</code>, use one
of the following sets of configuration options.</p>
<ul>
<li><code>configure --enable-epetra</code>
<p>This will automatically use the environmental variable 
<code>TRILINOS_HOME</code>
to find the necessary headers and libraries.</p>
<li><code>configure --with-trilinos=/home/jdoe/Trilinos</code>
<p>This will automatically search the directory
<code>/home/jdoe/Trilinos</code> to find the necessary headers and
libraries. 
More specifically, it will look in the following locations
for <code>Epetra_Vector.h</code>:</p>
<ul>
<li>directory optionally specified by <code>--with-epetra-include</code>
<li><code>/home/jdoe/Trilinos/include</code>
<li><code>/home/jdoe/Trilinos/include/epetra/</code>
<li><code>/home/jdoe/Trilinos/packages/epetra/src</code>
</ul>
<p>Similarily, it will look in the following locations
for <code>AztecOO.h</code>:</p>
<ul>
<li>directory optionally specified by <code>--with-aztecoo-include</code>
<li><code>/home/jdoe/Trilinos/include</code>
<li><code>/home/jdoe/Trilinos/include/aztecoo/</code>
<li><code>/home/jdoe/Trilinos/packages/aztecoo/src</code>
</ul>
<p>These include files are used in building libnoxepetra.a.
</p>
<p> Further, if we are also building the Epetra examples, we will look
for epetra, aztecoo, and ifpack libraries. For example, we would
search for <code>libepetra.a</code> in the following
directories:</p>
<ul>
<li>directory optionally specified by <code>--with-epetra-libdir</code>
<li><code>/home/jdoe/Trilinos/lib</code>
<li><code>/home/jdoe/Trilinos/lib/epetra</code>
<li><code>/home/jdoe/Trilinos/lib/$TRILINOS_TARGET</code>
</ul>
<p>In the above, if <code>TRILINOS_TARGET</code> is not defined as an
environmental variable, configure will define it.</p>
</ul>


<h5>Building the Epetra Examples</h5>

To compile the examples for NOX-Epetra, do the following:
<blockquote>
<code>configure --enable-epetra --enable-epetra-examples</code>.
</blockquote>

<h3>Using MPI</h3>

NOX itself does not care about MPI. However, the Epetra-based examples
can make use of MPI. So, we include some configuration options to
support MPI.


<h5>Using the MPI C++ Compiler</h5>
<p>Most MPI
packages come with a wrapper to the compiler that specifies the
correct flags, include files, libraries, and so on to compile with
MPI. This is often the easiest way to compile with MPI.</p>
<ul>
<li> <code>configure --with-mpi-cxx</code> 
<p> Use the default MPI C++ compiler (<code>mpiCC</code>). </P>
<li> <code>configure --with-mpi-cxx=/home/jdoe/mpich-1.2.3/bin/mpiCC</code>
<p>Specify the exact name and location of the MPI C++ compiler. This is
useful if you have multiple installations of MPI or if <code>mpiCC</code>
is not in your default path.</p>
</ul>

<h5>Specifying the MPI Include Directories, Library Directories, and
Libraries</h5>

<p>An alternative to using <code>mpiCC</code> is to specify the
include directory, library directory, and libraries specifically,
There are several flags that you can use to do this. These are
generally incompatible with <code>--with-mpi-cxx</code>
</p>

<ul>
<li> <code>configure --with-mpi=/home/jdoe/lam</code>
<p>This specifies the general location of the MPI installation. We
then assume that the headers are located in
<code>/home/jdoe/lam/include</code>, that the libraries are
located in <code>/home/jdoe/lam/lib</code>, and that the
library is specifed by <code>-lmpi</code>.
</p>
<li> <code>configure --with-mpi=/home/jdoe/mpich --with-mpi-libs="-lmpich"</code>
<p>This is the same as above except that the library to be linked with
is explicitly specified.
</p>
<li> <code>configure --with-mpi-include="/home/jdoe/lam/include" 
           --with-mpi-libdir="/home/jdoe/lam/lib"</code>
<p>Specify the exact locations of the MPI include files and the MPI
libraries. Assumes that the
library is specifed by <code>-lmpi</code>.
</p>
<li> <code>configure --with-mpi-include="/home/jdoe/mpich/include"
	   --with-mpi-libdir="/home/jdoe/mpich/lib"
	   --with-mpi-libs="-lmpich"</code>
<p>This is the same as above except that the library to be linked with
is explicitly specified.
</p>
<li> <code>configure --with-mpi-include="/home/jdoe/mpich/include"
	   --with-mpi-libs="/home/jdoe/mpich/lib/libmpich.a"</code>
</code>
<p>Explicitly specify the MPI library without specifying the library directory.
</p>
</ul>

</body>
</html>
