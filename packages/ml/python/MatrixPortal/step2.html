<?php 
  include 'common/header.php';
  include 'common/util.php';
  setBodyAttributes('onload="grabFocus();"'); 
  setFilename('index.html');
  setTitle('Matrix Portal -- Step 2: Parameters');
  setDir('./');
  include 'common/config.php';
  include 'common/header.html';

  process_variables();

  global $ProblemIDs;
  global $ResultIDs;

  check_data();
?>

<!-- begin content ######################################################### -->

  <? step_header("2"); ?>

  <font color=blue>You are at Step 2: Select Data</font>

  <p>In this step, you should specify what linear solution techniques you want to analyze.
  Several choices are possible; for example, if you want to test the symmetric Gauss-Seidel
  preconditioner, first click on the "Relaxation Preconditioners" to show all the
  parameters of this class of preconditioners, then
  click on the "Yes" button where "analyze symmetric Gauss-Seidel" is reported. You can also select the number of sweeps and the damping parameter, or just take the default values.
The same should
  be done with any other family of preconditioners.
  You can enable as many solution techniques as you want. All problems you have selected at step 1
  will be tested with all the specified solution techniques.

  <p>You also have to specify how to evaluate the solution phase. The evaluation parameter,
  called <b>phi</b>, is defined as a linear combition of CPU time, iterations and estimated condition number.
  The weights are defined in the "Performance Evaluation" section of this page.

  <p>To <b>continue</b>, proceed to Step 3 (Compute Data) using the button at the
  bottom of the page. Note that if you don't specify any preconditioners, Step 3 will be an empty box.

  <!-- --------------------------------------------------------------------- -->
  
  <br/>
  <div class="problemIDs">
  <?php print_problem_and_result($ProblemIDs, $ResultIDs); ?> 
  </div>
  <p>

  <p>
  <? print_form(); ?>

  <!-- --------------------------------------------------------------------- -->
  
<!-- end content ########################################################### -->

<?php include 'common/footer.html'; ?>

<?
  function print_form() { ?>

  <form action="step3.html" enctype="multipart/form-data" method="post" name="inputForm">

    <!-- ---------------------------------------------------------- -->

    <div class="formSection">
    <p class="subheading">
    <a onclick="toggle('general');" onkeypress="toggle('general');">General Settings</p>

    <div class=open id=general>
    <table class="formTable" cellspacing="0" cellpadding="0">
      <tr>
        <td>Solver: </td>
        <td>
        <select name="az_solver">
        <option value=AZ_gmres checked="checked">GMRES
        <option value=AZ_gmres_condnum>GMRES with condnum
        <option value=AZ_cg>CG
        <option value=AZ_cg_condnum>CG with condnum
        <option value=AZ_cgs>CGS
        <option value=AZ_tfqmr>TFQMR
        </select></td>
      </tr>
      <tr>
        <td>Maximum iterations: </td><td>
        <select name="iters">
        <option value=1550 checked="checked">1550
        <option value=1>1
        <option value=2>2
        <option value=4>4
        <option value=8>8
        <option value=16>16
        <option value=32>32
        <option value=64>64
        <option value=128>128
        <option value=256>256
        <option value=512>512
        <option value=1024>1024
        </select></td>
      </tr>
      <tr>
        <td>Tolerance: </td>
        <td>
        <select name="tol">
        <option value="1e-5" checked="checked">1e-5
        <option value="1e-1">1e-1
        <option value="1e-2">1e-2
        <option value="1e-3">1e-3
        <option value="1e-4">1e-4
        <option value="1e-5">1e-5
        <option value="1e-6">1e-6
        <option value="1e-7">1e-7
        <option value="1e-8">1e-8
        <option value="1e-9">1e-9
        <option value="1e-10">1e-10
        <option value="1e-11">1e-11
        <option value="1e-12">1e-12
        </select></td>
      </tr>
      <tr>
        <td>Krylov output: </td>
        <td>
        <select name="az_output">
        <option value="16">residual every 16 its
        <option value="32">residual every 32 its
        <option value="AZ_last">only last iterations
        <option value="AZ_none">none
        </select></td>
      </tr>
      <tr>
        <td>Size of Krylov space (for GMRES only): </td>
        <td>
        <select name="az_kspace">
        <option value="5">5
        <option value="10">10
        <option value="20">20
        <option value="30">30
        <option value="60">60
        <option value="2000">200
        </select></td>
      </tr>
      <tr>
        <td>Solution (unless present in H/B file): </td>
        <td>
        <select name="solution">
        <option value="random">Random
        <option value="zero">Zero
        <option value="constant">Constant
        </select></td>
      </tr>
      <tr>
        <td>Starting Solution (unless present in H/B file): </td>
        <td>
        <select name="starting_solution">
        <option value="zero">Zero
        <option value="random">Random
        <option value="constant">Constant
        </select></td>
      </tr>
      <tr>
        <td>Right-hand size (unless present in H/B file): </td>
        <td>
        <select name="rhs">
        <option value="matvec">b = A * x
        <option value="zero">Zero
        <option value="random">Random
        <option value="constant">Constant
        </select></td>
      </tr>
    </table><br />

    </div>
    </div>
    <p>

    <!-- ---------------------------------------------------------- -->

    <p>
    <div class="formSection">
    <p class="subheading">
    <a onclick="toggle('cheby');" onkeypress="toggle('cheby');">Chebyshev Preconditioners:
    <a href="help/step2_chebyshev.html"
       onclick='window.open(this.href,null,"height=300,width=400,status=yes,scrollbars=yes, toolbar=no,menubar=no,location=no"); return false;'
       class="help">?</a></p>

    <div class=closed id=cheby>
    <table class="formTable" cellspacing="0" cellpadding="0">
      <tr>
        <td>Analyze Chebyshev Preconditioners: </td><td>
        <input type="radio" name="perform_cheby" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_cheby" value="False" checked> No
      </tr>
      <tr>
    </table><br />

    <table class="formTable" cellspacing="0" cellpadding="0">
    <? begin_select_parameter("Degree of the polynomial", "chebyshev: degree", "i"); ?>
    <? for ($i = 1; $i < 6; ++$i)
         add_select_parameter("$i", "$i"); ?>
    <? end_select_parameter(); ?>
    </table><br />
    </div>
    </div>

    <!-- ---------------------------------------------------------- -->

    <p>
    <div class="formSection">
    <p class="subheading">
    <a onclick="toggle('relax');" onkeypress="toggle('relax');">Relaxation Preconditioners (Jacobi, Gauss-Seidel, SGS)
    <a href="help/step2_relaxation.html"
       onclick='window.open(this.href,null,"height=300,width=400,scrollbars=yes,status=yes,toolbar=no,menubar=no,location=no"); return false;'
       class="help">?</a></p>

    <div class=closed id=relax>
    <table class="formTable" cellspacing="0" cellpadding="0">
      <tr>
        <td>Analyze Jacobi Preconditioners: </td><td>
        <input type="radio" name="perform_jacobi" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_jacobi" value="False" checked> No
      </tr>
      <tr>
        <td>Analyze Gauss-Seidel Preconditioners: </td><td>
        <input type="radio" name="perform_gs" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_gs" value="False" checked> No
      </tr>
      <tr>
        <td>Analyze symmetric Gauss-Seidel Preconditioners: </td><td>
        <input type="radio" name="perform_sgs" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_sgs" value="False" checked> No
      </tr>
    </table><br />

    <table class="formTable" cellspacing="0" cellpadding="0">
    <? begin_select_parameter("Damping factor", "relaxation: damping factor", "d"); ?>
    <? add_select_parameter("0.67", "0.67"); ?>
    <? add_select_parameter("0.2", "0.2"); ?>
    <? add_select_parameter("0.4", "0.4"); ?>
    <? add_select_parameter("0.6", "0.6"); ?>
    <? add_select_parameter("0.8", "0.8"); ?>
    <? add_select_parameter("1.0", "1.0"); ?>
    <? add_select_parameter("1.2", "1.2"); ?>
    <? add_select_parameter("1.4", "1.4"); ?>
    <? add_select_parameter("1.6", "1.6"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Number of sweeps", "relaxation: sweeps", "i"); ?>
    <? add_select_parameter("1", "1"); ?>
    <? add_select_parameter("2", "2"); ?>
    <? add_select_parameter("3", "3"); ?>
    <? add_select_parameter("4", "4"); ?>
    <? add_select_parameter("5", "5"); ?>
    <? end_select_parameter(); ?>
    </table><br />
    </div>
    </div>

    <!-- ---------------------------------------------------------- -->

    <p>
    <div class="formSection">
    <p class="subheading">
    <a onclick="toggle('ifpack');" onkeypress="toggle('ifpack');">
    Incomplete Factorization Preconditioners (IC, ICT, ILU, ILUT)</a>
     <a href="help/step2_incomplete_factorization.html"
       onclick='window.open(this.href,null,"height=300,width=400,scrollbars=yes,status=yes,toolbar=no,menubar=no,location=no"); return false;'
       class="help">?</a></p>

    <div class=closed id=ifpack>
    <table class="formTable" cellspacing="0" cellpadding="0">
      <tr>
        <td>Analyze IC Preconditioners: </td><td>
        <input type="radio" name="perform_ic" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_ic" value="False" checked> No
      </tr>
      <tr>
        <td>Analyze ICT Preconditioners:</td><td>
        <input type="radio" name="perform_ict" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_ict" value="False" checked> No
      </tr>
      <tr>
        <td>Analyze ILU Preconditioners: </td><td>
        <input type="radio" name="perform_ilu" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_ilu" value="False" checked> No
      </tr>
      <tr>
        <td>Analyze ILUT Preconditioners:</td><td>
        <input type="radio" name="perform_ilut" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_ilut" value="False" checked> No
      </tr>
    </table><br />

    <table class="formTable" cellspacing="0" cellpadding="0">
    <? begin_select_parameter("Level-of-fill for ILU and IC", "fact: level-of-fill", "i"); ?>
    <? for ($i = 0; $i < 10; ++$i)
         add_select_parameter("$i", "$i"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Levell-of-fill for ICT", "fact: ict level-of-fill", "d"); ?>
    <? for ($i = 1; $i < 10; ++$i)
         add_select_parameter("$i.0", "$i.0"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Level-of-fill for ILUT", "fact: ilut level-of-fill", "d"); ?>
    <? for ($i = 1; $i < 10; ++$i)
         add_select_parameter("$i.0", "$i.0"); ?>
    <? end_select_parameter(); ?>
    </table><br />
    </div>
    </div>

    <!-- ---------------------------------------------------------- -->

    <p>
    <div class="formSection">
    <p class="subheading">
    <a onclick="toggle('ml');" onkeypress="toggle('ml');">Multilevel Preconditioners</a>
    <a href="help/step2_multilevel.html"
       onclick='window.open(this.href,null,"height=300,width=400,scrollbars=yes,status=yes,toolbar=no,menubar=no,location=no"); return false;'
       class="help">?</a></p>

    <div class=closed id=ml>
    <table class="formTable" cellspacing="0" cellpadding="0">
      <tr>
        <td>Analyze Multilevel Preconditioners: </td><td>
        <input type="radio" name="perform_ml" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_ml" value="False" checked> No
      </tr>
    </table><br />

    <p>
    <table class="formTable" cellspacing="0" cellpadding="0">
    <? begin_select_parameter("Output level", "output", "i"); ?>
    <? for ($i = 0; $i<11; ++$i)
         add_select_parameter("$i", "$i"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Maximum number of levels", "max levels", "i"); ?>
    <? add_select_parameter("10", "10"); ?>
    <? add_select_parameter("9", "9"); ?>
    <? add_select_parameter("8", "8"); ?>
    <? add_select_parameter("7", "7"); ?>
    <? add_select_parameter("6", "6"); ?>
    <? add_select_parameter("5", "5"); ?>
    <? add_select_parameter("4", "4"); ?>
    <? add_select_parameter("3", "3"); ?>
    <? add_select_parameter("2", "2"); ?>
    <? add_select_parameter("1", "1"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Maximum coarse size", "coarse: max size", "i"); ?>
    <? add_select_parameter("32", "32"); ?>
    <? add_select_parameter("128", "128"); ?>
    <? add_select_parameter("512", "512"); ?>
    <? add_select_parameter("1024", "1024"); ?>
    <? add_select_parameter("2048", "2048"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Number of PDE equations", "PDE equations", "i"); ?>
    <? for ($i = 1; $i < 11; ++$i)
         add_select_parameter("$i", "$i"); ?>
    <? end_select_parameter(); ?>

    <tr><td>&nbsp;</tr></tr>

    <? begin_select_parameter("Strategy to compute lambda_max", "eigen-analysis: type", "s"); ?>
    <? add_select_parameter("power-method", "10 steps of the power method"); ?>
    <? add_select_parameter("cg", "10 steps of CG"); ?>
    <? add_select_parameter("Anorm", "infinite norm of the matrix"); ?>
    <? end_select_parameter(); ?>

    <tr><td>&nbsp;</tr></tr>

    <? begin_select_parameter("Damping factor for aggregation", "aggregation: damping factor", "d"); ?>
    <? add_select_parameter("1.333", "classical SA: 1.333"); ?>
    <? add_select_parameter("0.0", "Non-smoothed Aggregation: 0.0"); ?>
    <? add_select_parameter("1.0", "SA with 1.0"); ?>
    <? add_select_parameter("1.5", "SA with 1.5"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Aggregation scheme", "aggregation: type", "s"); ?>
    <? add_select_parameter("Uncoupled-MIS", "Uncoupled-MIS"); ?>
    <? add_select_parameter("Uncoupled", "Uncoupled"); ?>
    <? add_select_parameter("MIS", "MIS"); ?>
    <? add_select_parameter("METIS", "METIS"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Nodes per aggregete (for METIS aggregation scheme only)", "aggregation: nodes per aggregate", "i"); ?>
    <? add_select_parameter("32", "32"); ?>
    <? add_select_parameter("64", "64"); ?>
    <? add_select_parameter("128", "128"); ?>
    <? add_select_parameter("256", "256"); ?>
    <? add_select_parameter("512", "512"); ?>
    <? add_select_parameter("1024", "1024"); ?>
    <? end_select_parameter(); ?>

    <tr><td>&nbsp;</td></tr>

    <? begin_select_parameter("Smoother type for level 0 (finest level)", "smoother: type (level 0)", "s"); ?>
    <? add_select_parameter("symmetric Gauss-Seidel", "symmetric Gauss-Seidel"); ?>
    <? add_select_parameter("Jacobi", "Jacobi"); ?>
    <? add_select_parameter("Gauss-Seidel", "Gauss-Seidel"); ?>
    <? add_select_parameter("block Gauss-Seidel", "block Gauss-Seidel"); ?>
    <? add_select_parameter("Chebyshev", "Chebyshev"); ?>
    <? add_select_parameter("MLS", "MLS"); ?>
    <? add_select_parameter("IC", "IC"); ?>
    <? add_select_parameter("ILU", "ILU"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Smoother type for level 1", "smoother: type (level 1)", "s"); ?>
    <? add_select_parameter("symmetric Gauss-Seidel", "symmetric Gauss-Seidel"); ?>
    <? add_select_parameter("Jacobi", "Jacobi"); ?>
    <? add_select_parameter("Gauss-Seidel", "Gauss-Seidel"); ?>
    <? add_select_parameter("block Gauss-Seidel", "block Gauss-Seidel"); ?>
    <? add_select_parameter("Chebyshev", "Chebyshev"); ?>
    <? add_select_parameter("MLS", "MLS"); ?>
    <? add_select_parameter("IC", "IC"); ?>
    <? add_select_parameter("ILU", "ILU"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Smoother type for level 2", "smoother: type (level 2)", "s"); ?>
    <? add_select_parameter("symmetric Gauss-Seidel", "symmetric Gauss-Seidel"); ?>
    <? add_select_parameter("Jacobi", "Jacobi"); ?>
    <? add_select_parameter("Gauss-Seidel", "Gauss-Seidel"); ?>
    <? add_select_parameter("block Gauss-Seidel", "block Gauss-Seidel"); ?>
    <? add_select_parameter("Chebyshev", "Chebyshev"); ?>
    <? add_select_parameter("MLS", "MLS"); ?>
    <? add_select_parameter("IC", "IC"); ?>
    <? add_select_parameter("ILU", "ILU"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Smoother type for level >=3", "smoother: type (level 3)", "s"); ?>
    <? add_select_parameter("symmetric Gauss-Seidel", "symmetric Gauss-Seidel"); ?>
    <? add_select_parameter("Jacobi", "Jacobi"); ?>
    <? add_select_parameter("Gauss-Seidel", "Gauss-Seidel"); ?>
    <? add_select_parameter("block Gauss-Seidel", "block Gauss-Seidel"); ?>
    <? add_select_parameter("Chebyshev", "Chebyshev"); ?>
    <? add_select_parameter("IC", "IC"); ?>
    <? add_select_parameter("ILU", "ILU"); ?>
    <? end_select_parameter(); ?>

    <tr><td>&nbsp;</tr></tr>

    <? begin_select_parameter("pre or post smoother", "smoother: pre or post", "s"); ?>
    <? add_select_parameter("both", "both"); ?>
    <? add_select_parameter("presmoother", "pre"); ?>
    <? add_select_parameter("postsmoother", "post"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Damping factor (for relaxation smoothers only)", "smoother: damping factor", "d"); ?>
    <? add_select_parameter("0.67", "0.67"); ?>
    <? add_select_parameter("0.2", "0.2"); ?>
    <? add_select_parameter("0.4", "0.4"); ?>
    <? add_select_parameter("0.6", "0.6"); ?>
    <? add_select_parameter("0.8", "0.8"); ?>
    <? add_select_parameter("1.0", "1.0"); ?>
    <? add_select_parameter("1.2", "1.2"); ?>
    <? add_select_parameter("1.4", "1.4"); ?>
    <? add_select_parameter("1.6", "1.6"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Number of sweeps (for relaxation smoothers only)", "smoother: sweeps", "i"); ?>
    <? add_select_parameter("1", "1"); ?>
    <? add_select_parameter("2", "2"); ?>
    <? add_select_parameter("3", "3"); ?>
    <? add_select_parameter("4", "4"); ?>
    <? add_select_parameter("5", "5"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Degree of the polynomial (for polynomial preconditioner only)", "smoother: polynomial order", "i"); ?>
    <? for ($i = 1; $i < 6; ++$i)
         add_select_parameter("$i", "$i"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Level-of-fill (for IC and ILU only)", "smoother: level-of-fill", "i"); ?>
    <? for ($i = 0; $i < 6; ++$i)
         add_select_parameter("$i", "$i"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Overlap (for IC and ILU only)", "smoother: overlap", "i"); ?>
    <? for ($i = 0; $i < 6; ++$i)
         add_select_parameter("$i", "$i"); ?>
    <? end_select_parameter(); ?>

    </table><br />

    </div>
    </div>

    <!-- ---------------------------------------------------------- -->

    <p>
    <div class="formSection">
    <p class="subheading"><font color=blue>
    <a onclick="toggle('item1');" onkeypress="toggle('item1');">Performance Evaluation</a></font>
    <a href="help/step2_performance.html"
       onclick='window.open(this.href,null,"height=300,width=400,scrollbars=yes,status=yes,toolbar=no,menubar=no,location=no"); return false;'
       class="help">?</a></p>

    <div class=closed id=item1>
    <table class="formTable" cellspacing="0" cellpadding="0">
      <tr><td>  phi = </td><td>

        <? begin_select_parameter_notable("evaluation: setup time", "d"); ?>
        <? add_select_parameter_notable("0.0", "0.0"); ?>
        <? add_select_parameter_notable("1.0", "1.0"); ?>
        <? end_select_parameter_notable(); ?>

        </td><td> x&nbsp; Setup CPU time (s)</td> <td> + </td>
      </tr>  
      <tr><td></td><td>

        <? begin_select_parameter_notable("evaluation: solution time", "d"); ?>
        <? add_select_parameter_notable("0.0", "0.0"); ?>
        <? add_select_parameter_notable("1.0", "1.0"); ?>
        <? end_select_parameter_notable(); ?>

        </td><td> x&nbsp; Solution CPU time (s)</td> <td> + </td>
      </tr>  
      <tr><td></td><td>

        <? begin_select_parameter_notable("evaluation: iterations", "d"); ?>
        <? add_select_parameter_notable("1.0", "1.0"); ?>
        <? add_select_parameter_notable("0.0", "0.0"); ?>
        <? end_select_parameter_notable(); ?>

        </td><td> x&nbsp; iterations</td> <td> + </td>
      </tr>  
      <tr><td></td><td>

        <? begin_select_parameter_notable("evaluation: condnum", "d"); ?>
        <? add_select_parameter_notable("0.0", "0.0"); ?>
        <? add_select_parameter_notable("1.0", "1.0"); ?>
        <? end_select_parameter_notable(); ?>

        </td><td> x&nbsp; cond(P A) </td><td> (requires CG or GMRES with condnum) </td>
      </tr>  
    </table><br />
    </div>
    </div>

    <!-- php marker for stage in form process -->
    <input type="hidden" name="stage" value="process_iterative">
    <input type="hidden" name="ProblemIDs" value="<? global $ProblemIDs; echo $ProblemIDs; ?>">
    <input type="hidden" name="ResultIDs" value="<? global $ResultIDs; echo $ResultIDs; ?>">
    <input type="hidden" name="counter" value="<? global $counter; echo $counter; ?>">
    <input type="hidden" name="perform_analysis" value="False">
  

  <br>
  Continue to:
  <input type="submit" class=submitSecondary name="submit" value="Step 3: Compute">
  
  </form>
  
<? } ?>
