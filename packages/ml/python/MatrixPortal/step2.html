<?php 
  include 'common/header.php';
  include 'common/util.php';
  setBodyAttributes('onload="grabFocus();"'); 
  setFilename('index.html');
  setTitle('Matrix Portal -- Step 2: Parameters');
  setDir('./');
  include 'common/config.php';
  include 'common/header.html';

  process_variables();

  global $ProblemIDs;
  global $ResultIDs;
?>

<!-- begin content ######################################################### -->

  <? step_header("2"); ?>

  You are at Step 2: Select Data.

  <p>In this step, you should specify what linear solution techniques you want to analyze.
  Several choices are possible; for example, if you want to test the symmetric Gauss-Seidel
  preconditioner, click on the "Yes" button where "analyze symmetric Gauss-Seidel" is reported.
  You can enable as many solution techniques as you want. All problems you have selected at step 1
  will be tested with all the specified solution techniques.

  <p>You also have to specify how to evaluate the solution phase. The evaluation parameter,
  called phi, is defined as a linear combition of CPU time, iterations and estimated condition number.
  The weights are defined in the "Performance Evaluation" section of this page.

  <p>To <b>continue</b>, proceed to Step 3 (Compute Data) using the button at the
  bottom of the page.</font>

  <!-- --------------------------------------------------------------------- -->
  
  <br/>
  <div class="problemIDs">
  <?php print_problem_and_result($ProblemIDs, $ResultIDs); ?> 
  </div>
  <p>

  <p>
  <? print_form(); ?>

  <!-- --------------------------------------------------------------------- -->
  
<!-- end content ########################################################### -->

<?php include 'common/footer.html'; ?>

<?
  function print_form() { ?>

  <form action="step3.html" enctype="multipart/form-data" method="post" name="inputForm">

    <!-- ---------------------------------------------------------- -->

    <div class="formSection">
    <p class="subheading">General Settings</p>

    <table class="formTable" cellspacing="0" cellpadding="0">
      <tr>
        <td>Solver: </td>
        <td>
        <select name="az_solver">
        <option value=AZ_gmres checked="checked">GMRES
        <option value=AZ_gmres_condnum>GMRES with condnum
        <option value=AZ_cg>CG
        <option value=AZ_cg_condnum>CG with condnum
        <option value=AZ_bicg>Bi-CG
        <option value=AZ_bicgstab>Bi-CGSTAB
        <option value=AZ_tfqmr>TFQMR
        </select></td>
        <!-- <input type="text" name="az_solver" value="AZ_gmres" /> -->
      </tr>
      <tr>
        <td>Maximum iterations: </td><td>
        <select name="iters">
        <option value=1550 checked="checked">1550
        <option value=1>1
        <option value=2>2
        <option value=4>4
        <option value=8>8
        <option value=16>16
        <option value=32>32
        <option value=64>64
        <option value=128>128
        <option value=256>256
        <option value=512>512
        <option value=1024>1024
        </select></td>
      </tr>
      <tr>
        <td>Tolerance: </td>
        <td>
        <select name="tol">
        <option value="1e-5" checked="checked">1e-5
        <option value="1e-1">1e-1
        <option value="1e-2">1e-2
        <option value="1e-3">1e-3
        <option value="1e-4">1e-4
        <option value="1e-5">1e-5
        <option value="1e-6">1e-6
        <option value="1e-7">1e-7
        <option value="1e-8">1e-8
        <option value="1e-9">1e-9
        <option value="1e-10">1e-10
        <option value="1e-11">1e-11
        <option value="1e-12">1e-12
        </select></td>
      </tr>
    </table><br />

    </div>
    <p>

    <!-- ---------------------------------------------------------- -->

    <p>
    <div class="formSection">
    <p class="subheading">Chebyshev Preconditioners:</p>

    <table class="formTable" cellspacing="0" cellpadding="0">
      <tr>
        <td>Analyze Chebyshev Preconditioners: </td><td>
        <input type="radio" name="perform_cheby" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_cheby" value="False" checked> No
      </tr>
      <tr>
    </table><br />

    <table class="formTable" cellspacing="0" cellpadding="0">
    <? begin_select_parameter("Degree of the polynomial", "chebyshev: degree", "i"); ?>
    <? for ($i = 1; $i < 6; ++$i)
         add_select_parameter("$i", "$i"); ?>
    <? end_select_parameter(); ?>
    </table><br />
    </div>

    <!-- ---------------------------------------------------------- -->

    <p>
    <div class="formSection">
    <p class="subheading">Relaxation Preconditioners</p>

    <table class="formTable" cellspacing="0" cellpadding="0">
      <tr>
        <td>Analyze Jacobi Preconditioners: </td><td>
        <input type="radio" name="perform_jacobi" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_jacobi" value="False" checked> No
      </tr>
      <tr>
        <td>Analyze Gauss-Seidel Preconditioners: </td><td>
        <input type="radio" name="perform_gs" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_gs" value="False" checked> No
      </tr>
      <tr>
        <td>Analyze symmetric Gauss-Seidel Preconditioners: </td><td>
        <input type="radio" name="perform_sgs" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_sgs" value="False" checked> No
      </tr>
    </table><br />

    <table class="formTable" cellspacing="0" cellpadding="0">
    <? begin_select_parameter("Damping factor", "relaxation: damping factor", "d"); ?>
    <? add_select_parameter("0.67", "0.67"); ?>
    <? add_select_parameter("0.2", "0.2"); ?>
    <? add_select_parameter("0.4", "0.4"); ?>
    <? add_select_parameter("0.6", "0.6"); ?>
    <? add_select_parameter("0.8", "0.8"); ?>
    <? add_select_parameter("1.0", "1.0"); ?>
    <? add_select_parameter("1.2", "1.2"); ?>
    <? add_select_parameter("1.4", "1.4"); ?>
    <? add_select_parameter("1.6", "1.6"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Number of sweeps", "relaxation: sweeps", "i"); ?>
    <? add_select_parameter("1", "1"); ?>
    <? add_select_parameter("2", "2"); ?>
    <? add_select_parameter("3", "3"); ?>
    <? add_select_parameter("4", "4"); ?>
    <? add_select_parameter("5", "5"); ?>
    <? end_select_parameter(); ?>
    </table><br />
    </div>

    <!-- ---------------------------------------------------------- -->

    <p>
    <div class="formSection">
    <p class="subheading">Incomplete Factorization Preconditioners</p>

    <table class="formTable" cellspacing="0" cellpadding="0">
      <tr>
        <td>Analyze IC Preconditioners: </td><td>
        <input type="radio" name="perform_ic" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_ic" value="False" checked> No
      </tr>
      <tr>
        <td>Analyze ICT Preconditioners:</td><td>
        <input type="radio" name="perform_ict" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_ict" value="False" checked> No
      </tr>
      <tr>
        <td>Analyze ILU Preconditioners: </td><td>
        <input type="radio" name="perform_ilu" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_ilu" value="False" checked> No
      </tr>
      <tr>
        <td>Analyze ILUT Preconditioners:</td><td>
        <input type="radio" name="perform_ilut" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_ilut" value="False" checked> No
      </tr>
    </table><br />

    <table class="formTable" cellspacing="0" cellpadding="0">
    <? begin_select_parameter("Level-of-fill for ILU and IC", "fact: level-of-fill", "i"); ?>
    <? for ($i = 0; $i < 10; ++$i)
         add_select_parameter("$i", "$i"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Levell-of-fill for ICT", "fact: ict level-of-fill", "d"); ?>
    <? for ($i = 1; $i < 10; ++$i)
         add_select_parameter("$i.0", "$i.0"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Level-of-fill for ILUT", "fact: ilut level-of-fill", "d"); ?>
    <? for ($i = 1; $i < 10; ++$i)
         add_select_parameter("$i.0", "$i.0"); ?>
    <? end_select_parameter(); ?>
    </table><br />
    </div>

    <!-- ---------------------------------------------------------- -->

    <p>
    <div class="formSection">
    <p class="subheading">Multilevel Preconditioners</p>

    <table class="formTable" cellspacing="0" cellpadding="0">
      <tr>
        <td>Analyze Multilevel Preconditioners: </td><td>
        <input type="radio" name="perform_ml" value="True"> Yes
        &nbsp; &nbsp;
        <input type="radio" name="perform_ml" value="False" checked> No
      </tr>
    </table><br />

    <p>
    <table class="formTable" cellspacing="0" cellpadding="0">
    <? begin_select_parameter("Maximum number of levels", "max levels", "i"); ?>
    <? add_select_parameter("10", "10"); ?>
    <? add_select_parameter("9", "9"); ?>
    <? add_select_parameter("8", "8"); ?>
    <? add_select_parameter("7", "7"); ?>
    <? add_select_parameter("6", "6"); ?>
    <? add_select_parameter("5", "5"); ?>
    <? add_select_parameter("4", "4"); ?>
    <? add_select_parameter("3", "3"); ?>
    <? add_select_parameter("2", "2"); ?>
    <? add_select_parameter("1", "1"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Maximum coarse size", "coarse: max size", "i"); ?>
    <? add_select_parameter("32", "32"); ?>
    <? add_select_parameter("128", "128"); ?>
    <? add_select_parameter("512", "512"); ?>
    <? add_select_parameter("1024", "1024"); ?>
    <? add_select_parameter("2048", "2048"); ?>
    <? end_select_parameter(); ?>

    <tr><td>&nbsp;</tr></tr>

    <? begin_select_parameter("Strategy to compute lambda_max", "eigen-analysis: type", "s"); ?>
    <? add_select_parameter("power-method", "10 steps of the power method"); ?>
    <? add_select_parameter("cg", "10 steps of CG"); ?>
    <? add_select_parameter("Anorm", "infinite norm of the matrix"); ?>
    <? end_select_parameter(); ?>

    <tr><td>&nbsp;</tr></tr>

    <? begin_select_parameter("Damping facto for aggregation", "aggregation: damping factor", "d"); ?>
    <? add_select_parameter("1.333", "classical SA: 1.333"); ?>
    <? add_select_parameter("0.0", "Non-smoothed Aggregation: 0.0"); ?>
    <? add_select_parameter("1.0", "SA with 1.0"); ?>
    <? add_select_parameter("1.5", "SA with 1.5"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Aggregation scheme", "aggregation: type", "s"); ?>
    <? add_select_parameter("Uncoupled-MIS", "Uncoupled-MIS"); ?>
    <? add_select_parameter("Uncoupled", "Uncoupled"); ?>
    <? add_select_parameter("MIS", "MIS"); ?>
    <? add_select_parameter("METIS", "METIS"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Nodes per aggregete (for METIS aggregation scheme only)", "aggregation: nodes per aggregate", "i"); ?>
    <? add_select_parameter("32", "32"); ?>
    <? add_select_parameter("64", "64"); ?>
    <? add_select_parameter("128", "128"); ?>
    <? add_select_parameter("256", "256"); ?>
    <? add_select_parameter("512", "512"); ?>
    <? add_select_parameter("1024", "1024"); ?>
    <? end_select_parameter(); ?>

    <tr><td>&nbsp;</td></tr>

    <? begin_select_parameter("Smoother type for level 0 (finest level)", "smoother: type (level 0)", "s"); ?>
    <? add_select_parameter("symmetric Gauss-Seidel", "symmetric Gauss-Seidel"); ?>
    <? add_select_parameter("Jacobi", "Jacobi"); ?>
    <? add_select_parameter("Gauss-Seidel", "Gauss-Seidel"); ?>
    <? add_select_parameter("block Gauss-Seidel", "block Gauss-Seidel"); ?>
    <? add_select_parameter("Chebyshev", "Chebyshev"); ?>
    <? add_select_parameter("MLS", "MLS"); ?>
    <? add_select_parameter("IC", "IC"); ?>
    <? add_select_parameter("ILU", "ILU"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Smoother type for level 1", "smoother: type (level 1)", "s"); ?>
    <? add_select_parameter("symmetric Gauss-Seidel", "symmetric Gauss-Seidel"); ?>
    <? add_select_parameter("Jacobi", "Jacobi"); ?>
    <? add_select_parameter("Gauss-Seidel", "Gauss-Seidel"); ?>
    <? add_select_parameter("block Gauss-Seidel", "block Gauss-Seidel"); ?>
    <? add_select_parameter("Chebyshev", "Chebyshev"); ?>
    <? add_select_parameter("MLS", "MLS"); ?>
    <? add_select_parameter("IC", "IC"); ?>
    <? add_select_parameter("ILU", "ILU"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Smoother type for level 2", "smoother: type (level 2)", "s"); ?>
    <? add_select_parameter("symmetric Gauss-Seidel", "symmetric Gauss-Seidel"); ?>
    <? add_select_parameter("Jacobi", "Jacobi"); ?>
    <? add_select_parameter("Gauss-Seidel", "Gauss-Seidel"); ?>
    <? add_select_parameter("block Gauss-Seidel", "block Gauss-Seidel"); ?>
    <? add_select_parameter("Chebyshev", "Chebyshev"); ?>
    <? add_select_parameter("MLS", "MLS"); ?>
    <? add_select_parameter("IC", "IC"); ?>
    <? add_select_parameter("ILU", "ILU"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Smoother type for level >=3", "smoother: type (level 3)", "s"); ?>
    <? add_select_parameter("symmetric Gauss-Seidel", "symmetric Gauss-Seidel"); ?>
    <? add_select_parameter("Jacobi", "Jacobi"); ?>
    <? add_select_parameter("Gauss-Seidel", "Gauss-Seidel"); ?>
    <? add_select_parameter("block Gauss-Seidel", "block Gauss-Seidel"); ?>
    <? add_select_parameter("Chebyshev", "Chebyshev"); ?>
    <? add_select_parameter("IC", "IC"); ?>
    <? add_select_parameter("ILU", "ILU"); ?>
    <? end_select_parameter(); ?>

    <tr><td>&nbsp;</tr></tr>

    <? begin_select_parameter("pre or post smoother", "smoother: pre or post", "s"); ?>
    <? add_select_parameter("both", "both"); ?>
    <? add_select_parameter("presmoother", "pre"); ?>
    <? add_select_parameter("postsmoother", "post"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Damping factor (for relaxation smoothers only)", "smoother: damping factor", "d"); ?>
    <? add_select_parameter("0.67", "0.67"); ?>
    <? add_select_parameter("0.2", "0.2"); ?>
    <? add_select_parameter("0.4", "0.4"); ?>
    <? add_select_parameter("0.6", "0.6"); ?>
    <? add_select_parameter("0.8", "0.8"); ?>
    <? add_select_parameter("1.0", "1.0"); ?>
    <? add_select_parameter("1.2", "1.2"); ?>
    <? add_select_parameter("1.4", "1.4"); ?>
    <? add_select_parameter("1.6", "1.6"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Number of sweeps (for relaxation smoothers only)", "smoother: sweeps", "i"); ?>
    <? add_select_parameter("1", "1"); ?>
    <? add_select_parameter("2", "2"); ?>
    <? add_select_parameter("3", "3"); ?>
    <? add_select_parameter("4", "4"); ?>
    <? add_select_parameter("5", "5"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Degree of the polynomial (for polynomial preconditioner only)", "smoother: polynomial order", "i"); ?>
    <? for ($i = 1; $i < 6; ++$i)
         add_select_parameter("$i", "$i"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Level-of-fill (for IC and ILU only)", "smoother: level-of-fill", "i"); ?>
    <? for ($i = 0; $i < 6; ++$i)
         add_select_parameter("$i", "$i"); ?>
    <? end_select_parameter(); ?>

    <? begin_select_parameter("Overlap (for IC and ILU only)", "smoother: overlap", "i"); ?>
    <? for ($i = 0; $i < 6; ++$i)
         add_select_parameter("$i", "$i"); ?>
    <? end_select_parameter(); ?>

    </table><br />

    </div>

    <!-- ---------------------------------------------------------- -->

    <p>
    <div class="formSection">
    <p class="subheading"><font color=blue>Performance Evaluation</font></p>

    <table class="formTable" cellspacing="0" cellpadding="0">
      <tr><td>  phi = </td><td>

        <? begin_select_parameter_notable("evaluation: setup time", "d"); ?>
        <? add_select_parameter_notable("0.0", "0.0"); ?>
        <? add_select_parameter_notable("1.0", "1.0"); ?>
        <? end_select_parameter_notable(); ?>

        </td><td> x&nbsp; Setup CPU time (s)</td> <td> + </td>
      </tr>  
      <tr><td></td><td>

        <? begin_select_parameter_notable("evaluation: solution time", "d"); ?>
        <? add_select_parameter_notable("0.0", "0.0"); ?>
        <? add_select_parameter_notable("1.0", "1.0"); ?>
        <? end_select_parameter_notable(); ?>

        </td><td> x&nbsp; Solution CPU time (s)</td> <td> + </td>
      </tr>  
      <tr><td></td><td>

        <? begin_select_parameter_notable("evaluation: iterations", "d"); ?>
        <? add_select_parameter_notable("1.0", "1.0"); ?>
        <? add_select_parameter_notable("0.0", "0.0"); ?>
        <? end_select_parameter_notable(); ?>

        </td><td> x&nbsp; iterations</td> <td> + </td>
      </tr>  
      <tr><td></td><td>

        <? begin_select_parameter_notable("evaluation: condnum", "d"); ?>
        <? add_select_parameter_notable("0.0", "0.0"); ?>
        <? add_select_parameter_notable("1.0", "1.0"); ?>
        <? end_select_parameter_notable(); ?>

        </td><td> x&nbsp; cond(P A) </td><td> (requires CG or GMRES with condnum) </td>
      </tr>  
    </table><br />
    </div>

    <!-- php marker for stage in form process -->
    <input type="hidden" name="stage" value="process_iterative">
    <input type="hidden" name="ProblemIDs" value="<? global $ProblemIDs; echo $ProblemIDs; ?>">
    <input type="hidden" name="ResultIDs" value="<? global $ResultIDs; echo $ResultIDs; ?>">
    <input type="hidden" name="counter" value="<? global $counter; echo $counter; ?>">
    <input type="hidden" name="perform_analysis" value="False">
  

  <br>
  Continue to:
  <input type="submit" class=submitSecondary name="submit" value="Step 3: Compute">
  
  </form>
  
<? } ?>
